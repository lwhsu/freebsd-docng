<?xml version="1.0" encoding="koi8-r"?>
<!DOCTYPE article PUBLIC "-//FreeBSD//DTD DocBook XML V5.0-Based Extension//EN"
	"http://www.FreeBSD.org/XML/share/xml/freebsd50.dtd">
<!--
     The FreeBSD Russian Documentation Project

     $FreeBSDru: frdp/doc/ru_RU.KOI8-R/articles/hubs/article.xml,v 1.21 2007/05/15 18:39:34 gad Exp $

     Original revision: r46284
-->
<article xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:lang="ru">
  <info><title>Поддержка зеркал FreeBSD</title>
    

    <authorgroup>
      <author><personname><firstname>Jun</firstname><surname>Kuriyama</surname></personname><affiliation>
	  <address><email>kuriyama@FreeBSD.org</email></address>
	</affiliation></author>

      <author><personname><firstname>Valentino</firstname><surname>Vaschetto</surname></personname><affiliation>
	  <address><email>logo@FreeBSD.org</email></address>
	</affiliation></author>

      <author><personname><firstname>Daniel</firstname><surname>Lang</surname></personname><affiliation>
	  <address><email>dl@leo.org</email></address>
	</affiliation></author>

      <author><personname><firstname>Ken</firstname><surname>Smith</surname></personname><affiliation>
	  <address><email>kensmith@FreeBSD.org</email></address>
	</affiliation></author>

      <author><personname><firstname>Дмитрий</firstname><surname>Морозовский</surname></personname><contrib>Перевод на русский язык: </contrib></author>
    </authorgroup>

    <legalnotice xml:id="trademarks" role="trademarks">
      &tm-attrib.freebsd;
      &tm-attrib.general;
    </legalnotice>

    <pubdate>$FreeBSD$</pubdate>

    <releaseinfo>$FreeBSD$</releaseinfo>

    <abstract>
      <para>Рабочий вариант статьи, описывающей процесс создания и поддержки
	зеркала FreeBSD и адресованной администраторам зеркал.</para>
    </abstract>
  </info>

  <note>
    <para>На текущий момент заявки на подключение новых зеркал
      не принимаются.</para>
  </note>

  <sect1 xml:id="mirror-contact">
    <title>Контактная информация</title>

    <para>Координаторы системы зеркал доступны по электронной почте по адресу
      <email>mirror-admin@FreeBSD.org</email>.  Помимо этого, существует
      &a.hubs;.</para>
  </sect1>

  <sect1 xml:id="mirror-requirements">
    <title>Требования к зеркалам FreeBSD</title>

    <sect2 xml:id="mirror-diskspace">
      <title>Дисковое пространство</title>

      <para>Одним из наиболее важных требований является дисковое пространство.
	В зависимости от набора релизов, архитектур и степени полноты зеркала
	вам может потребоваться огромный объем диска.  Не лишним будет
	помнить, что <emphasis>официальное</emphasis> зеркало, скорее всего,
	должно быть полным.  Веб-страницы всегда должны
	зеркалироваться полностью.  Кроме того, учтите, что приводимые оценки
	объема относятся к состоянию на момент последнего редактирования
	данной статьи (&rel2.current;-RELEASE/&rel.current;-RELEASE).
	Дальнейший процесс разработки и последующие релизы только увеличат
	требуемый объем.  Кроме того, разумно будет зарезервировать некоторое
	(10-20%) дополнительное пространство спокойствия ради.  Вот некоторые
	оценки объема:</para>

      <itemizedlist>
	<listitem>
	  <para>Полное зеркало FTP: 1.4 TB</para>
	</listitem>

	<listitem>
	  <para>Комплект изменений CTM: 10 GB</para>
	</listitem>

	<listitem>
	  <para>Веб-страницы: 1 GB</para>
	</listitem>
      </itemizedlist>

      <para>Текущее использование диска зеркалом FTP можно посмотреть на
	<link xlink:href="ftp://ftp.FreeBSD.org/pub/FreeBSD/dir.sizes">ftp://ftp.FreeBSD.org/pub/FreeBSD/dir.sizes</link>.</para>
    </sect2>

    <sect2 xml:id="mirror-bandwidth">
      <title>Требования к сетевой связности и пропускной способности</title>

      <para>Разумеется, у вас должно быть подключение к интернет.
	Требуемая пропускная способность ваших каналов зависит от
	предполагаемого профиля использования вашего зеркала.
	Если вы собираетесь копировать некоторые части FreeBSD для
	локального использования на вашей машине или в интранете,
	требования могут быть много мягче, чем для публичного зеркала.
	Для официального зеркала необходимая пропускная способность
	увеличивается еще больше.  Мы можем дать лишь очень грубые
	оценки:</para>

      <itemizedlist>
	<listitem>
	  <para>Зеркало для локального доступа: фактически минимум не
	    определен, но канал шириной менее 2 Mbps может сделать процесс
	    обновления мучительно медленным.</para>
	</listitem>

	<listitem>
	  <para>Неофициальное публичное зеркало: 34 Mbps выглядит
	    неплохо для начала.</para>
	</listitem>

	<listitem>
	  <para>Официальное зеркало: рекомендуется канал шириной более
	    100 Mbps; кроме того, ваша машина должна стоять как можно ближе к
	    граничным маршрутизаторам вашей сети.</para>
	</listitem>
      </itemizedlist>
    </sect2>

    <sect2 xml:id="mirror-system">
      <title>Системные требования, процессор и память</title>

      <para>Эти требования в первую очередь определяются максимальным ожидаемым
	количеством клиентов (устанавливается администратором сервера).
	Также, на требуемые ресурсы влияет список сервисов, которые вы будете
	предоставлять.  Зеркала FTP и/или HTTP не требуют особенно много
	ресурсов.  Будьте на чеку, если планируете предоставлять rsync.
	Выбор rsync может иметь огромное влияние на требования к аппаратным
	ресурсам, поскольку rsync признан "прожорливым" по памяти.
	Вот некоторые советы по конфигурации аппаратной части сервера:</para>

      <para>Для умеренно посещаемого сайта, предоставляющего
	<application>rsync</application>, можно использовать процессор
	с частотой 800MHz - 1 GHz и по крайней мере 512MB памяти.
	Скорее всего, данная конфигурация может считаться минимальной для
	<emphasis>официального</emphasis> зеркала.</para>

      <para>Для регулярно посещаемого сайта вам потребуется больше памяти
	(хорошим стартом будет 2GB) и больше процессорной мощности, что может
	означать требование многопроцессорной (SMP) платформы.</para>

      <para>Кроме того, вам потребуется быстрая дисковая подсистема, в первую
	очередь, для работы с репозиторием SVN (крайне рекомендуем RAID).
	Контроллер SCSI, оборудованный собственной памятью, также может
	ощутимо ускорить процесс, поскольку большая часть сервисов связана
	с большим количеством дисковых запросов небольшого размера.</para>
    </sect2>

    <sect2 xml:id="mirror-services">
      <title>Предоставляемые сервисы</title>

      <para>Всякое зеркало должно предоставлять набор основных сервисов.
	Помимо требуемого минимального набора, существуют дополнительные
	сервисы, которые администратор сервера может пожелать предоставлять.
	Этот раздел описывает, какие сервисы вы можете предоставлять, и какие
	действия для этого потребуются от вас.</para>

      <sect3 xml:id="mirror-serv-ftp">
	<title>FTP (требуется для FTP зеркала)</title>

	<para>Это один из наиболее базовых сервисов; его предоставление требуется
	  для каждого зеркала, распространяющего файлы FreeBSD по FTP.
	  Доступ по FTP должен быть анонимным, и не должны применяться
	  какие-либо ограничения по соотношению объема передано/принято
	  (что вообще является, на наш взгляд, странным подходом).
	  Закачка (upload) файлов на сервер не требуется (и
	  <emphasis>должна</emphasis> быть запрещена в разделе FreeBSD).
	  Кроме того, архив файлов FreeBSD должен быть доступен с путем
	  <filename>/pub/FreeBSD</filename>.</para>

	<para>
	  Для предоставления анонимного FTP доступа может быть использован
	  целый ряд программ (перечислены в алфавитном порядке):</para>

	<itemizedlist>
	  <listitem>
	    <para><command>/usr/libexec/ftpd</command>: базовый
	      FTP-даемон FreeBSD.  Не забудьте прочитать &man.ftpd.8;.</para>
	  </listitem>

	  <listitem>
	    <para><package>ftp/ncftpd</package>: коммерческий
	      пакет, свободен для использования в учебных целях.</para>
	  </listitem>

	  <listitem>
	    <para><package>ftp/oftpd</package>: FTP-даемон,
	      написанный в основном с точки зрения защищенности.</para>
	  </listitem>

	  <listitem>
	    <para><package>ftp/proftpd</package>: Модульный
	      и очень гибкий FTP-даемон.</para>
	  </listitem>

	  <listitem>
	    <para><package>ftp/pure-ftpd</package>:
	      Еще один FTP-даемон, разработанный с позиций защищенности.</para>
	  </listitem>

	  <listitem>
	    <para><package>ftp/twoftpd</package>:
	      См. предыдущий пункт.</para>
	  </listitem>

	  <listitem>
	    <para><package>ftp/vsftpd</package>:
	      <quote>очень защищенный</quote> (<quote>very secure</quote>)
	      ftpd.</para>
	  </listitem>
	</itemizedlist>

	<para><application>ftpd</application>,
	  <application>proftpd</application> и, возможно,
	  <application>ncftpd</application> являются наиболее часто
	  встречающимися FTP серверами.
	  Прочие распространены среди существующих зеркал в существенно
	  меньшей степени.  Дополнительным поводом для рассмотрения может
	  являться возможность гибко ограничивать количество одновременных
	  соединений, что поможет вам удержать в нужных рамках потребление
	  пропускной способности ваших каналов и машинные ресурсы.</para>
      </sect3>

      <sect3 xml:id="mirror-serv-rsync">
	<title>Rsync (необязательный сервис для FTP зеркала)</title>

	<para>
	  <application>Rsync</application> часто используется для
	  предоставления доступа к FTP-области FreeBSD, чтобы другие зеркала
	  могли синхронизироваться по вашему.  Протокол rsync во многом
	  отличается от FTP, в частности, он гораздо гуманнее с точки зрения
	  пропускной способности каналов, поскольку не требует передачи
	  измененного файла целиком (передаются лишь различия).  Взамен
	  <application>Rsync</application> требует значительных объемов
	  памяти.  Размер каждого процесса зависит от размера синхронизируемого
	  модуля (в основном от количества директорий и файлов).
	  <application>Rsync</application> может использовать в качестве
	  транспортного протокола <command>rsh</command> или
	  <command>ssh</command> (по умолчанию); также, может использоваться
	  внутренний протокол <application>rsync</application> (этот метод
	  предпочтителен для публичных rsync-серверов).
	  Поддерживается авторизация клиентов и различные ограничения.
	  Для протокола rsync существует единственный пакет:</para>

	<itemizedlist>
	  <listitem>
	    <para><package>net/rsync</package></para>
	  </listitem>
	</itemizedlist>
      </sect3>

      <sect3 xml:id="mirror-serv-http">
	<title>HTTP (требуется для веб-страниц, дополнителен для FTP зеркал)</title>
	<para>Если вы хотите поддерживать зеркало веб-страниц FreeBSD,
	  вам потребуется установить веб-сервер.
	  Дополнительно, вы можете предоставлять HTTP доступ к FTP-набору
	  файлов FreeBSD.  Выбор веб-сервера остается на усмотрение
	  администратора зеркала.  Некоторые из наиболее популярных
	  веб-серверов перечислены ниже.</para>

	<itemizedlist>
	  <listitem>
	    <para><package>www/apache13</package>:
	      <application>Apache</application>&nbsp;&mdash; самый
	      широко распространённый в Интернете веб-сервер, активно
	      используемый проектом FreeBSD.  Вы можете также использовать
	      веб-сервер <application>Apache</application> следующего
	      поколения, доступный в коллекции портов как
	      <package>www/apache22</package>.</para>
	  </listitem>

	  <listitem>
	    <para><package>www/thttpd</package>:
	      Для обслуживания большого количества запросов к статическим
	      документам сервер thttpd может оказаться более эффективным, чем
	      <application>Apache</application>.  thttpd отлично оптимизирован
	      по производительности при работе под FreeBSD.</para>
	  </listitem>

	  <listitem>
	    <para><package>www/boa</package>:
	      <application>Boa</application>&nbsp;&mdash; еще одна
	      альтернатива <application>thttpd</application> и
	      <application>Apache</application>.  Этот сервер
	      должен быть ощутимо более высокопроизводительным, чем
	      <application>Apache</application>,
	      для полностью статических страниц.  На время написания данного
	      документа, впрочем, он не так хорошо оптимизирован под
	      FreeBSD, как <application>thttpd</application>.</para>
	  </listitem>

	  <listitem>
	    <para><package>www/nginx</package>:
	      <application>Nginx</application> &mdash;
	      высокопроизводительный веб-сервер, отличающийся низкими
	      требованиями к объему оперативной памяти и обладающий
	      ключевыми функциональными возможностями для построения
	      современной веб-инфраструктуры.  Функциональные
	      возможности включают следующее: HTTP-сервер, обратный
	      прокси для HTTP, почтовый прокси сервер, кеширование,
	      балансировка нагрузки, сжатие, ограничение количества
	      запросов, мультиплексирование и повторное использование
	      соединений, поддержка разгрузки SSL (SSL offload) и
	      вещания медиапотоков (media streaming).</para>
	  </listitem>
	</itemizedlist>
      </sect3>
   </sect2>
  </sect1>

  <sect1 xml:id="mirror-howto">
    <title>Как вести зеркало FreeBSD</title>

    <para>Теперь вам известно, какая потребуется машина и как предоставлять
      сервисы, но не как получить их самому. :-)
      В этом разделе описывается процесс ведения зеркала и поддержания
      его в актуальном состоянии, в том числе какие инструменты
      использовать и какие сайты выбирать в качестве источников для
      синхронизации.</para>

    <sect2 xml:id="mirror-ftp-rsync">
      <title>Зеркалирование FTP-области</title>

      <para>Файлы, доступные по FTP, составляют большую часть зеркала.
	Они включают <emphasis>дистрибутивные наборы</emphasis>, необходимые
	для установки по сети, <emphasis>ветви (branches)</emphasis>,
	в которых отражено текущее состояние исходных текстов,
	<emphasis>образы ISO</emphasis> для записи компакт-дисков с
	дистрибутивами для установки, образами <quote>живых</quote> файловых
	систем и пакетами, дерево портов, исходные дистрибутивы для сборки
	портов и кучу готовых пакетов.  И, разумеется, все
	вышеописанное&nbsp;&mdash; для разных версий FreeBSD и различных
	архитектур.</para>

      <para>Наиболее эффективным будет синхронизация FTP-области при помощи
	  <application>rsync</application>.  Для этого следует установить
	  пакет <package>net/rsync</package>, который был
	  описан в разделе <xref linkend="mirror-serv-rsync"/>.
	  Поскольку доступ по протоколу <application>rsync</application> не
	  является обязательным, выбранный вами сайт может его не
	  поддерживать.  Возможно, вам придется немного поискать в сетевой
	  окрестности зеркало, поддерживающее
	  <application>rsync</application>.</para>

	<note>
	  <para>Поскольку от количества клиентов
	    <application>rsync</application> ощутимо зависит загрузка сервера,
	    большинство администраторов вводят ограничения доступа.  Для
	    поддержания зеркала вам следует связаться с администратором сайта,
	    с которым вы будете синхронизироваться, для уточнения локальных
	    правил и, возможно, для внесения в них исключения для вас
	    (поскольку вы также поддерживаете зеркало).</para>
	</note>

	<para>Строка для синхронизации FreeBSD по rsync выглядит примерно
	  так:</para>

	<screen>&prompt.user; <userinput>rsync -vaHz --delete rsync://ftp4.de.FreeBSD.org/FreeBSD/ /pub/FreeBSD/</userinput></screen>

	<para>Загляните в документацию по <application>rsync</application>,
	  также доступную по адресу
	  <link xlink:href="http://rsync.samba.org/">http://rsync.samba.org/</link>
	  за дополнительной информацией по различным опциям rsync.
	  Обратите внимание, что в случае синхронизации модуля целиком (а не
	  отдельного каталога) необходимо явно указать результирующий каталог,
	  потому что каталог с именем модуля (в данном случае "FreeBSD")
	  не создается.  Для поддержания актуальности вам потребуется
	  создать скрипт для запуска подобной команды из &man.cron.8;.</para>
    </sect2>

    <sect2 xml:id="mirror-www">
      <title>Зеркалирование страниц WWW</title>

      <para>Веб-сайт &os; следует зеркалировать исключительно при
	помощи <application>rsync</application>.</para>

      <para>Командная строка для синхронизации веб-сайта &os;
	выглядит примерно так:</para>

      <screen>&prompt.user; <userinput>rsync -vaHz --delete rsync://bit0.us-west.freebsd.org/FreeBSD-www-data/ /usr/local/www/</userinput></screen>
    </sect2>

    <sect2 xml:id="mirror-how-often">
      <title>Как часто синхронизироваться?</title>

      <para>Каждое зеркало должно регулярно обновляться.  Вам потребуется
	какой-то набор скриптов, выполняемых посредством &man.cron.8;.
	Поскольку каждый администратор, как правило, пишет такие скрипты сам
	и на свой лад, мы не можем выдать конкретных указаний.  Общие же советы
	выглядят так:</para>

      <procedure>
	<step>
	  <para>Создайте скрипт с командой, которая запустит нужное приложение
	    для обновления зеркала.  Рекомендуем использовать скрипт на языке
	    обычного <command>/bin/sh</command>.</para>
	</step>

	<step>
	  <para>Добавьте команд перенаправления вывода, чтобы записать
	    диагностику работы в файл.</para>
	</step>

	<step>
	  <para>Попробуйте, как ваш скрипт работает.  По завершении проверьте
	    логи.</para>
	</step>

	<step>
	  <para>При помощи утилиты &man.crontab.1; добавьте ваш скрипт в таблицу
	    регулярных заданий &man.crontab.5; соответствующего пользователя.
	    Это должен быть пользователь, отличный от пользователя FTP-даемона,
	    чтобы файлы в FTP-области без атрибута "чтение для всех" не были
	    доступны анонимным FTP-пользователям.  Данное свойство используется
	    для тестирования перед выходом новых релизов, для того чтобы
	    удостовериться, что все официальные зеркала содержат все
	    необходимые файлы к моменту официального объявления релиза.</para>
	</step>
      </procedure>

      <para>Некоторые рекомендуемые установки частоты обновления:</para>

      <itemizedlist>
	<listitem>
	  <para>FTP-набор: раз в сутки</para>
	</listitem>

	<listitem>
	  <para>WWW-страницы: раз в сутки</para>
	</listitem>
      </itemizedlist>
    </sect2>
  </sect1>

  <sect1 xml:id="mirror-where">
    <title>С какого сервера синхронизироваться</title>

    <para>Это важный вопрос, так что мы попытаемся пояснить, откуда берутся
      ответы.  Для начала повторим еще несколько раз: <emphasis>никогда
      не синхронизируйтесь с <systemitem class="fqdomainname">ftp.FreeBSD.org</systemitem>
      </emphasis>.</para>

    <sect2 xml:id="mirror-where-organization">
      <title>Организация системы зеркал</title>

      <para>Зеркала организуются по странам.  Имена хостов всех официальных
	зеркал построены по принципу
	<systemitem class="fqdomainname">ftpN.CC.FreeBSD.org</systemitem>,
	где <emphasis>CC</emphasis> (country code)&nbsp;&mdash; домен
	верхнего уровня страны, где расположено зеркало,
	<emphasis>N</emphasis>&nbsp;&mdash; номер зеркала в данной стране.
	Этот же принцип применим к именам хостов
	<systemitem>wwwN.CC.FreeBSD.org</systemitem> и т.п.
	Кроме того, есть зеркала без доменной части, обозначающей страну.
	Все они имеют очень хорошие внешние каналы и обслуживают большое число
	одновременных соединений.
	Имя <systemitem class="fqdomainname">ftp.FreeBSD.org</systemitem> на самом деле
	указывает на две машины, одна из которых в настоящее время находится
	в Дании, а другая в США.
	Ни одна из этих машин <emphasis>НЕ</emphasis> является основным
	сайтом, и потому не должна использоваться для синхронизации.
	Масса документации для <quote>живых</quote> пользователей указывает на
	<systemitem class="fqdomainname">ftp.FreeBSD.org</systemitem>, так что автоматическим
	системам ведения зеркал следует выбирать другие источники
	синхронизации.</para>

      <para>Кроме того, существует иерархия зеркал в терминах их удаленности от
	центра, или <emphasis>слоях</emphasis>.  Основные сайты могут быть
	описаны как <emphasis>Зеркала нулевого слоя</emphasis>.  Зеркала,
	синхронизирующиеся по ним, считаются <emphasis>слоем 1</emphasis>,
	следующие&nbsp;&mdash; <emphasis>слоем 2</emphasis> и т.д.  Официальные
	сайты приглашаются на низкие слои, однако следует помнить, что чем
	меньше номер слоя, тем выше требования к зеркалу, как было описано в
	<xref linkend="mirror-requirements"/>.  Помимо того, доступ к
	зеркалам 1 слоя может быть ограничен; безусловно ограничен доступ к
	основным сайтам.  Иерархия <emphasis>слоев</emphasis> не отражается в
	DNS и, вообще говоря, нигде (кроме мастер-сайтов) не документирована.
	Тем не менее, официальные зеркала с малыми (1-4, как правило) номерами
	обычно представляют первый слой.  (Это грубая оценка, и ни в коем
	случае не правило).</para>
    </sect2>

    <sect2 xml:id="mirror-where-where">
      <title>Так откуда же мне синхронизироваться?</title>

      <para>Главное&nbsp;&mdash; НЕ с
	<systemitem class="fqdomainname">ftp.FreeBSD.org</systemitem>.  Короткий ответ:
	с зеркала, которое расположено недалеко от вас в терминах Интернет,
	и/или доступ к которому наилучший.</para>

      <sect3 xml:id="mirror-where-simple">
	<title>Я хочу получить копию зеркала хоть откуда-нибудь!</title>

	<para>Если у вас нет каких-либо специальных предпочтений или
	  требований, см. <xref linkend="mirror-where-where"/>.
	  Это означает:</para>

	<procedure>
	  <step>
	    <para>Выберите те из них, с которыми вам работать быстрее всего
	      (меньшее число промежуточных узлов и время отклика), и которые
	      предоставляют нужные вам сервисы (такие как
	      <application>rsync</application>).</para>
	  </step>

	  <step>
	    <para>Свяжитесь с администраторами выбранного сервера, опишите
	      ваши запросы и уточните их правила.</para>
	  </step>

	  <step>
	    <para>Сконфигурируйте ваше зеркало, как описывалось выше.</para>
	  </step>
	</procedure>
      </sect3>

      <sect3 xml:id="mirror-where-official">
	<title>Я поддерживаю официальное зеркало, какой сайт
	  мне выбрать?</title>

	<para>В основном, правила, описанные в
	  <xref linkend="mirror-where-simple"/>, применимы.  Дополнительно
	  можно убедиться, что выбранный сайт принадлежит низкому слою.
	  Другие соображения относительно <emphasis>официальных</emphasis>
	  зеркал описаны в <xref linkend="mirror-official"/>.</para>
      </sect3>

      <sect3 xml:id="mirror-where-master">
	<title>Мне нужен доступ к основным сайтам!</title>

	<para>При наличии достаточных причин вы можете получить доступ
	  к одному из основных сайтов.  Доступ к ним ограничен; существуют
	  специальные правила их использования.  Наличие у вас статуса
	  <emphasis>официального</emphasis> зеркала, безусловно, является
	  хорошим подспорьем.  В противном случае убедитесь, что ваша
	  страна действительно нуждается еще в одном зеркале.
	  Если их уже три или более, сначала свяжитесь с администратором
	  соответствующей зоны DNS (<email>hostmaster@CC.FreeBSD.org</email>)
	  или напишите в &a.hubs;.</para>

	<para>Доступ к одному из мастер-сайтов или подходящему зеркалу 1 уровня
	  вам помогут обеспечить те же, кто помогал вам получить статус
	  <emphasis>официального</emphasis> зеркала.  В случае неудачи
	  свяжитесь с <email>mirror-admin@FreeBSD.org</email> и попросите
	  помощи у них.</para>

	<para>Существует один основной сайт для синхронизации набора файлов
	  FTP.</para>

	<sect4 xml:id="mirror-where-master-ftp">
	  <title>ftp-master.FreeBSD.org</title>

	  <para>Это основной сервер для синхронизации FTP набора.</para>

	  <para>В дополнение к FTP, <systemitem>ftp-master.FreeBSD.org</systemitem>
	    поддерживает доступ по <application>rsync</application>.
	    Использование этих протоколов описано в
	    <xref linkend="mirror-ftp-rsync"/>.</para>

	  <para>Приветствуется предоставление зеркалами
	    <emphasis>1 уровня</emphasis> доступа к FTP-области по протоколу
	    <application>rsync</application>.</para>
	</sect4>
      </sect3>
    </sect2>
  </sect1>

  <sect1 xml:id="mirror-official">
    <title>Официальные зеркала</title>

    <para>Официальные зеркала обладают следующим свойствами:</para>

    <itemizedlist>
      <listitem>
	<para>a) имеют запись в домене <systemitem>FreeBSD.org</systemitem>
	  (обычно типа CNAME).</para>
      </listitem>

      <listitem>
	<para>b) присутствуют в списке официальных зеркал в Руководстве
	  по FreeBSD и другой документации.</para>
      </listitem>
    </itemizedlist>

    <para>На настоящий момент это все, что отличает их от прочих зеркал.
      Официальные зеркала не обязательно принадлежат к
      <emphasis>Первому уровню</emphasis>, однако, вряд ли можно найти
      зеркало <emphasis>уровня 1</emphasis>, не являющееся официальным.</para>

    <sect2 xml:id="mirror-official-requirements">
      <title>Отдельные требования к официальным зеркалам 1 уровня</title>

      <para>Описать требования для всех официальных зеркал не так просто,
	поскольку проект FreeBSD достаточно мягок в этом отношении.
	Несколько проще указать, что требуется от <emphasis>официальных
	зеркал уровня 1</emphasis>.  Прочие официальные зеркала должны
	рассматривать этот список как <emphasis>настойчивые
	пожелания</emphasis>.</para>

      <para>Зеркала 1 уровня должны:</para>

      <itemizedlist>
	<listitem>
	  <para>поддерживать полный список файлов</para>
	</listitem>

	<listitem>
	  <para>предоставлять доступ для других зеркал</para>
	</listitem>

	<listitem>
	  <para>обеспечивать доступ по протоколам
	    <application>FTP</application> и
	    <application>rsync</application>.</para>
	</listitem>
      </itemizedlist>

      <para>Кроме того, администратор такого зеркала должен быть подписан
	на &a.hubs;.  См. <link xlink:href="http://www.FreeBSD.org/doc/ru_RU.KOI8-R/books/handbook/eresources.html#ERESOURCES-MAIL">здесь</link>
	для дополнительной информации о подписке.</para>

      <important>
	<para>Администраторы зеркал, в особенности 1 уровня, должны
	  <emphasis>очень</emphasis> внимательно следить за
	  <link xlink:href="http://www.FreeBSD.org/releng/">графиком релизов</link>.
	  Это поможет подготовиться к крупным всплескам нагрузки на зеркало,
	  которые всегда происходят после очередного релиза.</para>

	<para>Кроме того, важно поддерживать актуальность зеркал (в особенности
	  зеркал уровня 1).  Если Зеркало1 не синхронизировалось в течение
	  длительного времени, то зеркала следующего уровня будут
	  синхронизироваться по устаревшей информации и т.д.
	  Поддерживайте актуальность ваших зеркал!</para>
      </important>
    </sect2>

    <sect2 xml:id="mirror-official-become">
      <title>Как стать официальным зеркалом?</title>
<!--
      <para>Небезынтересный вопрос, в особенности если учитывать последствия
	становления официальным зеркалом, например, увеличившиеся счета
	за интернет от вашего провайдера (ведь нагрузка на ваш сервер
	неизбежно увеличится).  Статус официального зеркала может быть
	ключевым требованием для доступа к основному сайту.</para>

      <para>Прежде чем отправлять заявку, убедитесь в необходимости
	дополнительного официального зеркала в вашем регионе.  Справьтесь у
	администратора вашей зоны (<email>hostmaster@CC.FreeBSD.org</email>)
	или, в случае, если вам не отвечают, здесь: &a.hubs;.</para>

      <para>Собственно процедура такова:</para>

      <procedure>
	<step>
	  <para>Обеспечьте работоспособность и актуальность зеркала (скорее
	    всего, синхронизируясь не по основному сайту).</para>
	</step>

	<step>
	  <para>Подпишитесь <ulink url="http://www.FreeBSD.org/doc/ru_RU.KOI8-R/books/handbook/eresources.html#ERESOURCES-MAIL">здесь</ulink>
	    на &a.hubs;.</para>
	</step>

	<step>
	  <para>После успешного завершения предыдущих пунктов, напишите
	    администратору DNS вашего региона (страны) и попросите его создать
	    запись в зоне для вашего сайта.  Почтовый адрес администратора
	    <email>hostmaster@CC.FreeBSD.org</email>, где
	    <emphasis>CC</emphasis>&nbsp;&mdash; код вашей страны (и суффикс
	    домена верхнего уровня).  Формат вашей записи в DNS описан в
	    <xref linkend="mirror-where-organization"/>.</para>

	  <para>Если для вашей страны пока не создано поддомена, свяжитесь с
	    <email>mirror-admin@FreeBSD.org</email> или сначала напишите
	    в &a.hubs;.</para>
	</step>

	<step>
	  <para>Персона, помогавшая вам получить статус официального зеркала,
	    должна послать письмо <email>mirror-admin@FreeBSD.org</email>,
	    чтобы ваш сайт был включен в список официальных зеркал в <ulink
	    url="http://www.FreeBSD.org/doc/ru_RU.KOI8-R/books/handbook">
	    Руководстве FreeBSD</ulink>.</para>
	</step>
      </procedure>
-->
      <!-- XXX Ну не писать же здесь "как-нибудь так (с) Масяня" [marck] ;-))) XXX
      <para>That is it.</para>
      -->
      <para>На текущий момент заявки на подключение новых зеркал
	не принимаются.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="mirror-statpages">
    <title>Статистика некоторых зеркал</title>

    <para>Вот несколько ссылок на статистику использования зеркал</para>

    <sect2 xml:id="mirror-statpagesftp">
      <title>Статистика FTP сайтов</title>

      <itemizedlist>
	<listitem>
	  <para>ftp.is.FreeBSD.org - <email>hostmaster@is.FreeBSD.org</email> -
	    <link xlink:href="http://www.rhnet.is/status/draupnir/draupnir.html">
	    (загрузка канала)</link>
	    <link xlink:href="http://www.rhnet.is/status/ftp/ftp-notendur.html">(FTP
	    процессы)</link>
	    <link xlink:href="http://www.rhnet.is/status/ftp/http-notendur.html">
	    (HTTP процессы)</link></para>
	</listitem>

	<listitem>
	  <para>ftp.cz.FreeBSD.org - <email>cejkar@fit.vutbr.cz</email> -
	    <link xlink:href="http://www.cz.FreeBSD.org/stats/mrtg/net.html">
	    (загрузка канала)</link>
	    <link xlink:href="http://www.freebsd.cz/stats/mrtg/ftpd.html">
	    (FTP процессы)</link>
	    <link xlink:href="http://www.freebsd.cz/stats/mrtg/rsyncd.html">
	    (rsync процессы)</link></para>
	</listitem>

	<listitem>
	  <para>ftp2.ru.FreeBSD.org - <email>mirror@macomnet.ru</email> -
	    <link xlink:href="http://mirror.macomnet.net/mrtg/mirror.macomnet.net_195.128.64.25.html">(Bandwidth)</link>
	    <link xlink:href="http://mirror.macomnet.net/mrtg/mirror.macomnet.net_proc.html">(HTTP and FTP users)</link></para>
	</listitem>
      </itemizedlist>
    </sect2>
  </sect1>
</article>

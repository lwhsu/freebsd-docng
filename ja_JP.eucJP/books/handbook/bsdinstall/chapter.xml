<?xml version="1.0" encoding="euc-jp"?>
<!--
     The FreeBSD Documentation Project
     The FreeBSD Japanese Documentation Project

     Original revision: r54495
     $FreeBSD$
-->
<chapter xmlns="http://docbook.org/ns/docbook"
  xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0"
  xml:id="bsdinstall">

  <info>
    <title>&os; のインストール</title>

    <authorgroup>
      <author>
	<personname>
	  <firstname>Jim</firstname>
	  <surname>Mock</surname>
	</personname>

	<contrib>再構成、部分的に書き直し: </contrib>
      </author>
    </authorgroup>
<!--
    <authorgroup>
      <author>
	<personname>
	  <firstname>Randy</firstname>
	  <surname>Pratt</surname>
	</personname>
	<contrib>sysinstall のウォークスルー、スクリーンショット、
	  およびその他原稿: </contrib>
      </author>
    </authorgroup>-->

    <authorgroup>
      <author>
	<personname>
	  <firstname>Gavin</firstname>
	  <surname>Atkinson</surname>
	</personname>

	<contrib>bsdinstall に向けた改訂: </contrib>
      </author>

      <author>
	<personname>
	  <firstname>Warren</firstname>
	  <surname>Block</surname>
	</personname>
      </author>
    </authorgroup>

    <authorgroup>
      <author>
	<personname>
	  <firstname>Allan</firstname>
	  <surname>Jude</surname>
	</personname>

	<contrib>root-on-ZFS に向けた改訂: </contrib>
      </author>
    </authorgroup>
  </info>

  <sect1 xml:id="bsdinstall-synopsis">
    <title>この章では</title>

    <indexterm><primary>installation</primary></indexterm>

    <para>&os; を入手して実行する方法は、環境に依存します。
      以下のようにさまざま方法が用意されています。</para>

    <itemizedlist>
      <listitem>
	<para>ダウンロードして仮想環境にインストールするための仮想マシンイメージ。
	  これらのイメージは、<link
	    xlink:href="https://www.freebsd.org/ja/where.html">FreeBSD
	    を入手する</link> ページからダウンロードできます。
	  仮想マシンのイメージとして KVM
	  (<quote>qcow2</quote>), VMWare (<quote>vmdk</quote>),
	  Hyper-V (<quote>vhd</quote>) および広くサポートされている
	  raw デバイスイメージが用意されています。
	  これらはインストール用のイメージではなく、
	  すでに設定済みの (<quote>すでにインストールされた</quote>)
	  インスタンスで、すぐに起動して、
	  インストール後の作業を行うことができます。</para>
      </listitem>

      <listitem>
	<para>Amazon <link
	    xlink:href="https://aws.amazon.com/marketplace/pp/B07L6QV354">AWS
	    Marketplace</link>, <link
	    xlink:href="https://azuremarketplace.microsoft.com/en-us/marketplace/apps?search=freebsd&amp;page=1">Microsoft
	    Azure Marketplace</link> および <link
	    xlink:href="https://console.cloud.google.com/marketplace/details/freebsd-cloud/freebsd-12">Google
	    Cloud Platform</link>
	  において、
	  それぞれのホスティングサービスで実行可能な仮想マシンイメージを利用できます。
	  Azure での &os; のデプロイについての詳細な情報については、
	  <link
	    xlink:href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/freebsd-intro-on-azure">Azure
	    Documentation</link> の関連する章をご覧ください。</para>
      </listitem>

      <listitem>
	<para>Raspberry Pi または BeagleBone Black
	  といった組み込みシステム用に、SD カードイメージが用意されています。
	  これらのイメージは、
	  <link
	    xlink:href="https://www.freebsd.org/where.html">FreeBSD
	  を入手する</link> ページからダウンロードしてください。
	  これらのファイルをダウンロードしたら、展開し、
	  ボードが起動するように raw イメージとして SD
	  カードに書き込んでください。</para>
      </listitem>

      <listitem>
	<para>&os; を通常のデスクトップ、ラップトップ、
	  サーバシステムのハードディスク上にインストールするためのインストールイメージ。</para>
      </listitem>
    </itemizedlist>

    <para>この章では、4 番目のケースに関連して、
      テキストベースの
      <application>bsdinstall</application>
      と呼ばれるインストールプログラムの使い方について説明します。</para>

    <para>この章で記載されているインストールの手順は、
      &i386; および <acronym>AMD64</acronym> アーキテクチャを対象にしています。
      必要に応じて、他のプラットフォームに特有の手順についても明記しています。
      インストーラとこの文書で記載している内容には、
      いくらかズレがあることがありますので、
      この章を正確で忠実な手順書としてではなく、
      一般的なガイドとしてご利用ください。</para>

    <note><para>グラフィカルなインストーラで
      &os; をインストールしたいと考えているユーザは、
      <link xlink:href="https://www.furybsd.org">FuryBSD</link>,
      <link xlink:href="https://ghostbsd.org">GhostBSD</link> もしくは
      <link
	xlink:href="https://www.midnightbsd.org">MidnightBSD</link>
      に興味を持たれるでしょう。</para>
    </note>


    <para>この章では、以下について説明します。</para>

    <itemizedlist>
      <listitem>
	<para>最小ハードウェア要件、および &os;
	  が対応しているアーキテクチャについて。</para>
      </listitem>

      <listitem>
	<para>&os; インストールメディアの作り方。</para>
      </listitem>

      <listitem>
	<para><application>bsdinstall</application>
	  の起動方法。</para>
      </listitem>

      <listitem>
	<para><application>bsdinstall</application>
	  が聞いてくる質問がどのような意味であり、
	  またどのように答えれば良いか。</para>
      </listitem>

      <listitem>
	<para>インストールに失敗した時の問題の解決方法。</para>
      </listitem>

      <listitem>
	<para>インストールを確定する前に、
	  &os; の live 版へアクセスする方法。</para>
      </listitem>
    </itemizedlist>

    <para>この章を読む前に、以下のことを確認して下さい。</para>

    <itemizedlist>
      <listitem>
	<para>インストールしようとしているバージョンに付属しているサポートハードウェア一覧を読み、
	  システムのハードウェアがサポートされているかどうかを確認して下さい。</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xml:id="bsdinstall-hardware">
    <title>最小ハードウェア要件</title>

    <para>&os; をインストールするために必要なハードウェア要件は、
      アーキテクチャごとに異なります。&os;
      の各リリースが対応しているハードウェアアーキテクチャおよびデバイスの一覧は、
      <link
	xlink:href="&url.base;/ja/releases/index.html">&os;
	リリース情報</link> のページにまとめられています。
      アーキテクチャごとのイメージの選択に関しては、
      <link xlink:href="&url.base;/ja/where.html">&os;
	ダウンロードページ</link> でも説明されています。</para>

    <para>&os; をインストールするためには、
      少なくとも 96&nbsp;MB の <acronym>RAM</acronym>
      および 1.5&nbsp;GB のハードディスクの空き容量が必要です。
      しかしながら、このような少ないメモリやディスク容量のシステムは、
      組み込みアプライアンスのような、
      カスタムアプリケーションでのみ適しており、
      一般使用のデスクトップのシステムでは、
      より多くのリソースが必要となります。
      2-4&nbsp;GB RAM そして少なくとも 8&nbsp;GB
      のハードディスク容量を検討してください。</para>

    <para>以下は、各アーキテクチャごとのプロセッサの必要要件です。</para>

    <variablelist>
      <varlistentry>
	<term>&arch.amd64;</term>
	<listitem>
	  <para>デスクトップおよびラップトップのプロセッサとしては最も一般的で、
	    最近のほとんどのシステムで使われています。
	    &intel; は <acronym>Intel64</acronym> と呼び、
	    他の製造ベンダはしばしば <acronym>x86-64</acronym>
	    と呼びます。</para>

	  <para>&arch.amd64; 互換のプロセッサの例は、
	    &amd.athlon;64, &amd.opteron;,
	    マルチコアの &intel;&nbsp;&xeon; および 
	    &intel;&nbsp;&core;&nbsp;2 以降のプロセッサです。</para>
	</listitem>
      </varlistentry>

      <varlistentry>
      	<term>&arch.i386;</term>
	<listitem>
	  <para>古いデスクトップおよびラップトップでは、
	    この 32 ビットの X86 アーキテクチャが用いられています。</para>

	  <para>浮動小数点演算ユニットを持つ
	    i386 互換のほとんどのプロセッサに対応しています。
	    486 以上のすべての &intel; プロセッサに対応しています。</para>

	  <para>&os; は、Physical Address Extensions (<acronym>PAE</acronym>)
	    に対応した <acronym>CPU</acronym> でこの機能を利用可能です。
	    <acronym>PAE</acronym> 機能を有効にしたカーネルでは、
	    4 ギガバイト以上のメモリを認識し、システムが利用できます。
	    しかしながら、<acronym>PAE</acronym> を使うと、
	    デバイスドライバや &os;
	    の他の機能に制限を課してしまいます。</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>&arch.powerpc;</term>
	<listitem>
	  <para><acronym>USB</acronym> 内蔵のすべての
	    New World <acronym>ROM</acronym> &apple; &mac;
	    システムに対応しています。
	    複数の <acronym>CPU</acronym> を持つコンピュータは
	    <acronym>SMP</acronym> に対応しています。</para>

	  <para>32-bit カーネルは、<acronym>RAM</acronym> の最初の
	    2&nbsp;GB だけを利用できます。</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>&arch.sparc64;</term>
	<listitem>
	  <para>&os;/&arch.sparc64;
	    が対応しているハードウェアの一覧については、
	    <link
	      xlink:href="&url.base;/ja/platforms/sparc.html">
	    FreeBSD/sparc64 プロジェクト</link> をご覧ください。</para>

	  <para>複数のプロセッサを搭載するすべてのシステムにおいて、
	    <acronym>SMP</acronym> に対応しています。現時点では、
	    他のオペレーティングシステムとディスクの共有ができないので、
	    &os;/&arch.sparc64; 専用のディスクが必要です。</para>
	</listitem>
      </varlistentry>
    </variablelist>
  </sect1>

  <sect1 xml:id="bsdinstall-pre">
    <title>インストール前に行う作業</title>

    <para>システムが &os;
      のインストールにおける最小ハードウェア要件を満たしていることを確認したら、
      インストールファイルをダウンロードして、
      インストール用のメディアを用意してください。
      その前に、以下のチェックリストを確認して、
      システムをインストールする準備ができていることを確認してください。</para>

    <procedure>
      <step>
	<title>重要なデータのバックアップ</title>

	<para>オペレーティングシステムをインストールする前に、
	  <emphasis>常に</emphasis>
	  価値のあるすべてのデータを最初にバックアップしてください。
	  インストールしようとしているシステムにはバックをとらないでください。
	  そのかわり、<acronym>USB</acronym> ドライブ、
	  ネットワーク上の他のシステム、
	  もしくはオンラインのバックアップサービスといったリムーバルディスクにデータを保存してください。
	  インストールを始める前に、バックアップを調べて、
	  必要なすべてのファイルがバックアップに含まれていることを確認してください。
	  インストーラがシステムのディスクをフォーマットしてしまうと、
	  ディスクに保存されていたすべてのデータは失われます。</para>
      </step>

      <step>
	<title>&os; をインストールする場所の決定</title>

	<para>インストールするオペレーティングシステムが &os; のみであれば、
	  このステップは飛ばすことができます。
	  しかし、ディスクに &os; と
	  他のオペレーティングシステムを共存させる必要がある場合には、&os;
	  が利用するディスクおよびパーティションを決める必要があります。</para>

	<para>&arch.i386; および &arch.amd64; アーキテクチャでは、
	  二つのパーティションスキームのどちらかを使って、
	  ハードディスクを複数の塊に分割することができます。
	  伝統的な <firstterm>Master Boot Record</firstterm>
	  (<acronym>MBR</acronym>) では、
	  ディスク 1 台あたり最大 4 つの
	  <firstterm>プライマリパーティション</firstterm>
	  をパーティションテーブルに持つことができます
	  歴史的な理由により、&os; では、これらのパーティションのことを
	  <firstterm>スライス</firstterm> と呼びます。
	  プライマリパーティションの 1 つに、
	  複数の <firstterm>論理パーティション</firstterm> を含む
	  <firstterm>拡張パーティション</firstterm> を作成できます。
	  <firstterm>GUID Partition Table</firstterm>
	  (<acronym>GPT</acronym>) は、
	  ディスクをパーティションに分ける簡単で新しい方法です。
	  一般的な <acronym>GPT</acronym> の実装では、
	  1 つのディスクに 128 個までのパーティションの作成が可能であり、
	  論理パーティションは必要ありません。</para>

	<para>&os; のブートローダは、プライマリまたは
	  <acronym>GPT</acronym> パーティションのどちらかを必要とします。
	  ディスク上のプライマリ、もしくは
	  <acronym>GPT</acronym> パーティションがすべて使われているのであれば、
	  そのひとつを &os; のために開放してください。
	  ディスクにあるデータを消去せずにパーティションを作成するには、
	  パーティションサイズを変更するツールを使って今あるパーティションのサイズを小さくし、
	  空いたスペースに新しいパーティションを作成してください。</para>

	<para>パーティションサイズを変更するフリーや商用のツールは、
	  <link
	    xlink:href="http://en.wikipedia.org/wiki/List_of_disk_partitioning_software">http://en.wikipedia.org/wiki/List_of_disk_partitioning_software</link>
	  にまとめられています。
	  <application>GParted Live</application> (<link
	    xlink:href="http://gparted.sourceforge.net/livecd.php">http://gparted.sourceforge.net/livecd.php</link>)
	  は、<application>GParted</application>
	  パーティションエディタを含む完全なライブ <acronym>CD</acronym> です。
	  多くの Linux Live <acronym>CD</acronym> ディストリビューションでも
	  <application>GParted</application> を利用できます。</para>

	<warning>
	  <para>ディスクパーティションを縮小するユーティリティは、
	    適切に用いるとパーティション用の空き容量を新しく安全に作成できます。
	    すでにあるパーティションを間違って選択してしまう可能性があるので、
	    ディスクのパーティションを変更する前に、
	    必ず重要なデータのバックアップをとり、
	    バックアップが正しくとれていることを検証してください。</para>
	</warning>

	<para>ディスクパーティションごとに異なるオペレーティングシステムをインストールすることで、
	  一つのコンピュータに複数のオペレーティングシステムをインストールできます。
	  <link xlink:href="&url.books.handbook.en;/virtualization.html">仮想化技術</link>
	  を用いると、ディスクパーティションを変更することなく、
	  複数のオペレーティングシステムを同時に起動できます。</para>
      </step>

      <step>
	<title>ネットワーク情報の収集</title>

	<para>&os; のインストール方法によっては、ネットワークに接続し、
	  インストールファイルをダウンロードする必要があります。
	  インストールする方法に関わらず、インストール後に、
	  インストーラはシステムのネットワークインタフェースの設定をする機会を提供します。</para>

	<para>ネットワークに <acronym>DHCP</acronym> サーバがあると、
	  自動的にネットワークの設定情報を取得できます。
	  <acronym>DHCP</acronym> を利用できない環境では、
	  システムの以下のネットワーク情報について、
	  システム管理者かプロバイダにネットワーク情報を問い合わせる必要があります。</para>

	<orderedlist xml:id="bsdinstall-collect-network-information">
	  <title>必要となるネットワーク情報</title>

	  <listitem>
	    <para><acronym>IP</acronym> アドレス</para>
	  </listitem>

	  <listitem>
	    <para>サブネットマスク</para>
	  </listitem>

	  <listitem>
	    <para>デフォルトゲートウェイの
	      <acronym>IP</acronym> アドレス</para>
	  </listitem>

	  <listitem>
	    <para>ネットワークのドメイン名</para>
	  </listitem>

	  <listitem>
	    <para>ネットワークの <acronym>DNS</acronym>
	      サーバの <acronym>IP</acronym> アドレス</para>
	  </listitem>
	</orderedlist>
      </step>

      <step>
	<title>&os; Errata の確認</title>

	<para>&os;&nbsp;プロジェクトでは &os;
	  の各リリースができる限り安定するよう努力していますが、
	  時々バグが発生してしまうことがあります。極まれに、
	  発生したバグがインストールプロセスに影響を与えることがあります。
	  これらの問題は発見され解決されると、
	  &os; のウェブサイトの &os; Errata (<link
	    xlink:href="&url.base;/releases/&rel121.current;R/errata.html">https://www.freebsd.org/releases/&rel121.current;R/errata.html</link>)
	  に記載されます。
	  インストールに影響するような既知の問題が無いことを、
	  インストールする前に Errata で確認してください。</para>

	<para>すべてのリリースに関する情報や Errata は、&os; のウェブサイトの
	  リリース情報の項 (<link
	    xlink:href="&url.base;/ja/releases/index.html">https://www.freebsd.org/ja/releases/index.html</link>)
	  で確認できます。</para>
      </step>
    </procedure>

    <sect2 xml:id="bsdinstall-installation-media">
      <title>インストールメディアの準備</title>

      <para>&os; のインストーラは、
	他のオペレーティングシステムで実行できるようなプログラムではありません。
	そのかわり、&os; インストールファイルをダウンロードしたら、
	ファイルタイプやサイズに合わせてメディア
	(<acronym>CD</acronym>,
	<acronym>DVD</acronym> または <acronym>USB</acronym>)
	に焼いてください。そして、挿入したメディアからインストールするように、
	システムを起動してください。</para>

      <para>&os; のインストールファイルは <link
	  xlink:href="&url.base;/ja/where.html#download">www.freebsd.org/ja/where.html#download</link>
	から入手できます。
	各インストールファイルの名前は、&os;
	のリリースバージョンおよびアーキテクチャ、ファイルタイプからなります。
	たとえば、&arch.amd64; システムに <acronym>DVD</acronym> から
	&os; 12.1 をインストールするには、
	<filename>FreeBSD-12.1-RELEASE-amd64-dvd1.iso</filename>
	をダウンロードして、ファイルを <acronym>DVD</acronym>
	に焼き、<acronym>DVD</acronym>
	を挿入してからシステムを起動してください。</para>

      <para>インストールファイルは、さまざまな形式で用意されています。
	用意されているフォーマットは、
	コンピュータのアーキテクチャやメディアのタイプによって異なります。</para>
	
      <para xml:id="bsdinstall-installation-media-uefi"><acronym>UEFI</acronym>
	(Unified Extensible Firmware Interface)
	で起動するコンピュータのために、
	追加のインストールファイルも用意されています。
	これらのファイルの名前には、<filename>uefi</filename>
	という文字列が含まれています。</para>

      <para>ファイルの形式</para>

      <itemizedlist>
	<listitem>
	  <para><literal>-bootonly.iso</literal>:
	    インストーラのみを含む最小のインストールファイルです。
	    インストールを行う間、インストーラは
	    &os; をインストールするために必要なファイルをダウンロードするため、
	    ネットワーク接続が必要です。
	    このファイルは、<acronym>CD</acronym>
	    を焼くためのアプリケーションを用いて、
	    <acronym>CD</acronym> に書き込む必要があります。</para>
	</listitem>

	<listitem>
	  <para><literal>-disc1.iso</literal>: &os;
	    のインストールに必要となる、ソースおよび Ports Collection
	    といったすべてのファイルが含まれています。
	    このファイルは、<acronym>CD</acronym>
	    を焼くためのアプリケーションを用いて、
	    <acronym>CD</acronym> に書き込む必要があります。</para>
	</listitem>

	<listitem>
	  <para><literal>-dvd1.iso</literal>: &os;
	    のインストールに必要となる、ソースおよび Ports Collection
	    といったすべてのファイルが含まれています。
	    インターネットに接続することなく、
	    メディアのみでシステムのインストールを完了できるように、
	    良く使われるウィンドウマネージャおよびアプリケーションをインストールするためのバイナリ package も含まれています。
	    <acronym>DVD</acronym> を焼くためのアプリケーションを使って、
	    <acronym>DVD</acronym> に書き込む必要があります。</para>
	</listitem>

	<listitem>
	  <para><literal>-memstick.img</literal>: &os;
	    のインストールに必要となる、ソースおよび Ports Collection
	    といったすべてのファイルが含まれています。
	    以下の手順に従って、<acronym>USB</acronym>
	    スティックに書き込んでください。</para>
	</listitem>

	<listitem>
	  <para><literal>-mini-memstick.img</literal>:
	    <literal>-bootonly.iso</literal> と同じく、
	    インストールファイルは含まれていないため、
	    必要に応じてダウンロードする必要があります。
	    インストールを行う間、ネットワーク接続が必要です。 
	    <xref linkend="bsdinstall-usb"/> の説明に従って、
	    <acronym>USB</acronym> スティックに書き込んでください。</para>
	</listitem>
      </itemizedlist>

      <para>イメージファイルをダウンロードしたら、同じディレクトリから
	<filename>CHECKSUM.SHA256</filename> をダウンロードしてください。
	その後、イメージファイルの <firstterm>チェックサム</firstterm>
	を計算してください。
	&os; では、この計算のために &man.sha256.1; を提供しています。
	<command>sha256 <replaceable>イメージファイルの名前</replaceable></command>
	のように使用してください。
	他のオペレーティングシステムでも同じようなプログラムを利用できます。</para>

      <para>計算したチェックサムと <filename>CHECKSUM.SHA256</filename>
	に示されている値を比較してください。
	チェックサムは完全に一致している必要があります。
	もしチェックサムが一致しなければ、
	イメージファイルは壊れているので、もう一度ダウンロードしてください。</para>

      <sect3 xml:id="bsdinstall-usb">
	<title>イメージファイルを <acronym>USB</acronym> に書き込む</title>

	<para><filename>*.img</filename> ファイルは、
	  完全なメモリスティックの内容の <emphasis>イメージ</emphasis>
	  です。これは、
	  通常のファイルのように対象のデバイスにコピーすることは
	  <emphasis>できません</emphasis>。
	  <acronym>USB</acronym> スティックへ <filename>*.img</filename>
	  を書き込むためのアプリケーションは複数あります。
	  この節ではこのうちの二つのユーティリティについて説明します。</para>

	<important>
	  <para>先に進む前に、<acronym>USB</acronym>
	    スティックに存在する重要なデータをバックアップしてください。
	    以下の手順を実行すると、
	    スティックに存在するデータは削除されます。</para>
	</important>

	<procedure xml:id="bsdinstall-usb-dd">
	  <title><command>dd</command> を使ってイメージを書き込む</title>

	  <warning>
	    <para>この例では、イメージの書き込み先のターゲットデバイスとして、
	      <filename>/dev/da0</filename> が使われています。
	      ここで使われるコマンドは、
	      指定したターゲットデバイスに存在しているデータを破壊してしまうので、
	      正しいデバイスが指定されていることに
	      <emphasis>細心の注意を払ってください</emphasis>。</para>
	  </warning>

	  <step>
	    <para>&man.dd.1; コマンドユーティリティは、
	      BSD, &linux;, および &macos; システムで利用できます。
	      <command>dd</command> を使ってイメージを焼くには、
	      <acronym>USB</acronym> スティックを挿入して、
	      デバイス名を確定してください。
	      その後、ダウンロードしたインストールファイルおよび、
	      <acronym>USB</acronym> スティックのデバイス名を指定してください。
	      この例では、&arch.amd64; インストールイメージを
	      &os; システムの最初の
	      <acronym>USB</acronym> デバイスに書き込みます。</para>

	    <screen>&prompt.root; <userinput>dd if=<replaceable>FreeBSD-12.1-RELEASE-amd64-memstick.img</replaceable> of=/dev/<replaceable>da0</replaceable> bs=1M conv=sync</userinput></screen>

	    <para>もし上記のコマンドに失敗するようでしたら、
	      <acronym>USB</acronym> スティックがマウントされていないことや、
	      デバイス名がディスクに対してのものであり、
	      パーティションではないことを確認してください。
	      オペレーティングシステムによっては、このコマンドを
	      &man.sudo.8; で実行することが求められる場合があります。
	      &man.dd.1; の書式は、プラットフォームによって少し変わります。
	      たとえば &macos; では、小文字の <option>bs=1m</option>
	      を使う必要があります。
	      &linux; のようなシステムでは、書き込みをバッファします。
	      すべての書き込みを完了させるには、
	      &man.sync.8; を使用してください。</para>
	  </step>
	</procedure>

	<procedure>
	  <title>&windows; を使ってイメージを書き込む</title>

	  <warning>
	    <para>適切なドライブレターを出力先に設定していることを十分に確認してください。
	      さもなければ、現在あるデータは上書きされ、
	      破壊されてしまうでしょう。</para>
	  </warning>

	  <step>
	    <title><application>Image Writer for &windows;</application>
	      を入手する</title>

	    <para><application>Image Writer for &windows;</application> は、
	      イメージファイルをメモリスティックに正しく書き込むことのできるフリーのアプリケーションです。
	      <uri
		xlink:href="https://sourceforge.net/projects/win32diskimager/">https://sourceforge.net/projects/win32diskimager/</uri>
	      からダウンロードして、フォルダに展開してください。</para>
	  </step>

	  <step>
	    <title>イメージライタを使ってイメージを書き込む</title>

	    <para><application>Win32DiskImager</application>
	      アイコンをダブルクリックして、プログラムを起動してください。
	      <computeroutput>Device</computeroutput>
	      の下に表示されるデバイスレターが、
	      メモリスティックのドライブであることを確認してください。
	      フォルダのアイコンをクリックして、
	      メモリスティックに書き込むイメージファイルを選択します。
	      <guibutton>[&nbsp;Save&nbsp;]</guibutton> をクリックして、
	      イメージファイルの名前を確定してください。
	      すべてが正しく行われたかどうか、また、
	      他のウィンドウでメモリスティックのフォルダが開かれていないことを確認してください。
	      準備ができたら、<guibutton>[&nbsp;Write&nbsp;]</guibutton>
	      をクリックして、
	      メモリスティックにイメージファイルを書き込んでください。</para>
	  </step>
	</procedure>

	<para>これで &os; をインストールする用意ができました。</para>
      </sect3>
    </sect2>
  </sect1>

  <sect1 xml:id="bsdinstall-start">
    <title>インストールの開始</title>

    <important>
      <para>デフォルトでは、次のメッセージが表示されるまで
	インストーラはディスクに何の変更も加えません。</para>

      <programlisting>Your changes will now be written to disk. If you
have chosen to overwrite existing data, it will
be PERMANENTLY ERASED. Are you sure you want to
commit your changes?</programlisting>

      <para>この警告の前であれば、いつでもインストールを中断できます。
	もし、何かを間違って設定してしまったことが心配ならば、
	最後の警告の前に単にコンピュータをオフにしてください。
	システムのハードディスクを変更せずに済みます。</para>
    </important>

    <para>この章では、<xref linkend="bsdinstall-installation-media"/>
      で説明されている手順によって準備されたインストールメディアから、
      システムを起動する方法について説明します。
      起動可能な <acronym>USB</acronym> スティックを使用する場合には、
      コンピュータを立ち上げる前に、
      <acronym>USB</acronym> スティックを挿入してください。
      <acronym>CD</acronym> もしくは <acronym>DVD</acronym>
      から起動する場合には、
      コンピュータを立ち上げ、
      すぐにメディアを挿入してください。
      挿入したメディアからシステムを起動するように設定する方法は、
      アーキテクチャによって異なります。</para>

    <sect2 xml:id="bsdinstall-starting-i386">
      <title>&i386; および &arch.amd64; での起動</title>

      <para>これらのアーキテクチャでは、
	<acronym>BIOS</acronym> メニューが用意されており、
	ブートデバイスを選択できます。
	利用するインストールメディアに合わせて、
	最初のブートデバイスに、
	<acronym>CD</acronym>/<acronym>DVD</acronym> または
	<acronym>USB</acronym> を選択してください。
	ほとんどのシステムでは、<acronym>BIOS</acronym>
	に入らずとも、起動時に特定のキーを押すことで、
	起動するデバイスを選択できます。
	通常、このキーは、
	<keycap>F10</keycap>, <keycap>F11</keycap>,
	<keycap>F12</keycap> または <keycap>Escape</keycap>
	のどれかです。</para>

      <para>もし、コンピュータが &os; のインストーラではなく、
	すでに存在しているオペレーティングシステムで起動してしまったのであれば、
	以下の原因が考えられます。</para>

      <orderedlist>
	<listitem>
	  <para>インストールメディアが起動プロセスにおいて十分早いタイミングで挿入されていません。
	    メディアをそのままにしてコンピュータを再起動してください。</para>
	</listitem>

	<listitem>
	  <para><acronym>BIOS</acronym> の変更が適切に行われていなかったり、
	    変更が保存されていません。
	    最初のブートデバイスに正しいブートデバイスが設定されていることを確認してください。</para>
	</listitem>

	<listitem>
	  <para>システムが古く、
	    希望しているメディアからの起動に対応していません。
	    この場合には、<application>Plop Boot
	      Manager</application> (<link
	      xlink:href="http://www.plop.at/en/bootmanagers.html" />)
	    を使うと、選択したメディアからシステムを起動できます。</para>
	</listitem>
      </orderedlist>
    </sect2>

    <sect2>
      <title>&powerpc; での起動</title>

      <para>ほとんどのコンピュータでは、
	起動中にキーボードの <keycap>C</keycap>
	を押しておくと、<acronym>CD</acronym> から起動します。
	別の方法では <keycombo action="simul">
	  <keycap>Command</keycap>
	  <keycap>Option</keycap>
	  <keycap>O</keycap>
	  <keycap>F</keycap>
	</keycombo>、
	または non-&apple; キーボードでは
	<keycombo action="simul">
	  <keycap>Windows</keycap>
	  <keycap>Alt</keycap>
	  <keycap>O</keycap>
	  <keycap>F</keycap>
	</keycombo>
	を押してください。<prompt>0 &gt;</prompt> プロンプトで</para>

      <screen><userinput>boot cd:,\ppc\loader cd:0</userinput></screen>

      <para>と入力してください。</para>
    </sect2>

    <sect2 xml:id="bsdinstall-view-probe">
      <title>&os; ブートメニュー</title>

      <para>インストールメディアからシステムが起動すると、
	以下のようなメニューが表示されます。</para>

      <figure xml:id="bsdinstall-newboot-loader-menu">
	<title>&os; ブートローダメニュー</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-newboot-loader-menu"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>デフォルトでは、メニューは、&os; インストーラが起動するまで
	(&os; がインストールされているシステムでは、&os; が起動するまで)、
	ユーザからの入力を 10 秒間受け付けます。
	タイマーを停止してオプションを確認には、
	<keycap>Space</keycap> を押してください。オプションを選択するには、
	ハイライトされている番号、文字、もしくはキーを押してください。
	以下のオプションが利用可能です。</para>

      <itemizedlist>
	<listitem>
	  <para><literal>Boot Multi User</literal>: &os;
	    の起動プロセスを続けます。
	    ブートタイマが停止しているのであれば <keycap>1</keycap>、
	    大文字もしくは小文字の <keycap>B</keycap> または、
	    <keycap>Enter</keycap> を押してください。</para>
	</listitem>

	<listitem>
	  <para><literal>Boot Single User</literal>: このモードは、
	    すでにインストールされている &os; を修復するために利用できます。
	  　シングルユーザモードについては、
	    <xref linkend="boot-singleuser"/> で説明されています。
	    <keycap>2</keycap> もしくは、小文字もしくは、大文字の
	    <keycap>S</keycap> を押すとこのモードに入ることができます。 </para>
	</listitem>

	<listitem>
	  <para><literal>Escape to loader prompt</literal>: 
	    制限された低レベルのコマンドのみが利用可能な修復用プロンプトでシステムを起動します。
	    このプロンプトについては、
	    <xref linkend="boot-loader"/> で説明されています。
	    <keycap>3</keycap> または <keycap>Esc</keycap>
	    を押すとこのプロンプトで起動します。</para>
	</listitem>

	<listitem>
	  <para><literal>Reboot</literal>: システムを再起動します。</para>
	</listitem>

        <listitem>
          <para><literal>Kernel</literal>: 別のカーネルを読み込みます。</para>
        </listitem>

	<listitem>
	  <para><literal>Configure Boot Options</literal>: <xref
	      linkend="bsdinstall-boot-options-menu"/>
	    で示されるメニューを開きます。</para>
	</listitem>
      </itemizedlist>

      <figure xml:id="bsdinstall-boot-options-menu">
	<title>&os; ブートオプションメニュー</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-boot-options-menu"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>この起動オプションメニューは、
	2 つのセクションから構成されています。
	最初のセクションは、メインのブートメニューに戻ったり、
	オプションをデフォルト値に戻すために利用できます。</para>

      <para>次のセクションでは、変更可能なオプションついて、
	選択されている番号や文字を、<literal>On</literal> や
	<literal>Off</literal> に変更できます。
	システムは、これらのオプションが変更されない限り、
	常に変更されたオプションで起動します。
	このメニューで変更可能なオプションは以下の通りです。</para>

      <itemizedlist>
	<listitem>
	  <para><literal>ACPI Support</literal>:
	    起動中にシステムが固まるようでしたら、このオプションを
	    <literal>Off</literal> にしてください。</para>
	</listitem>

	<listitem>
	  <para><literal>Safe Mode</literal>:
	    上記のオプションの対応を行ってもシステムが起動時に固まるようでしたら、
	    <literal>ACPI Support</literal> を <literal>Off</literal>
	    にし、このオプションを <literal>On</literal>
	    に設定してください。</para>
	</listitem>

	<listitem>
	  <para><literal>Single User</literal>:
	    シングルユーザモードでインストールされている &os; を修復には、
	    <literal>On</literal> にしてください。
	    シングルユーザモードについては、
	    <xref linkend="boot-singleuser"/> で説明されています。
	    問題が修正された後は、<literal>Off</literal>
	    に戻してください。</para>
	</listitem>

	<listitem>
	  <para><literal>Verbose</literal>:
	    起動プロセスの表示をより詳細に表示したい場合には、
	    このオプションを <literal>On</literal> にしてください。
	    ハードウェアの問題を解決する際には有効です。</para>
	</listitem>
      </itemizedlist>

      <para>設定が終わったら、
	<keycap>1</keycap> または <keycap>Backspace</keycap>
	を押してメインブートメニューに戻り、
	<keycap>Enter</keycap> を押して &os; の起動を続けてください。
	&os; がハードウェアの検出を行い、
	インストールプログラムをロードしている間、
	ブートメッセージが表示されます。
	起動後、<xref linkend="bsdinstall-choose-mode"/>
	が表示されます。</para>

      <figure xml:id="bsdinstall-choose-mode">
	<title>ウェルカムメニュー</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-choose-mode"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><keycap>Enter</keycap> を押して、デフォルトの
	<guibutton>[&nbsp;Install&nbsp;]</guibutton>
	を選択すると、インストール作業が始まります。
	この章の残りの部分では、このインストーラの使い方について説明します。
	メニュー項目を選択する他の方法としては、
	左右の矢印キーを使ったり、色が変わっている文字を使ってください。
	<guibutton>[&nbsp;Shell&nbsp;]</guibutton> を選択すると、
	インストールの前に、&os;
	シェルからコマンドラインユーティリティでディスクを準備できます。
	<guibutton>[&nbsp;Live CD&nbsp;]</guibutton> オプションを選択すると、
	インストール前に &os; を試すことができます。
	live 版については、<xref linkend="using-live-cd"/>
	で説明されています。</para>

      <tip>
	<para>ハードウェアの検出などのブートメッセージを見るには
	  大文字または小文字の <keycap>S</keycap> を押してください。
	  その後、<keycap>Enter</keycap> を押して、
	  シェルにアクセスしてください。
	  シェルプロンプトから、<command>more
	    /var/run/dmesg.boot</command> を入力してください。
	  メッセージのスクロールには、スペースバーを使ってってください。
	  終わったら、<command>exit</command> を押して、
	  ウェルカムメニューに戻ってください。</para>
      </tip>
    </sect2>
  </sect1>

  <sect1 xml:id="using-bsdinstall">
    <title><application>bsdinstall</application> の使用</title>

    <para>この章では、
      <application>bsdinstall</application> メニューの順番と、
      システムがインストールされる前に、
      尋ねられる情報の形式について紹介します。
      メニューオプションの選択には、矢印キーを使い、
      メニューの項目の選択や解除する場合には、<keycap>Space</keycap>
      キーを使ってください。
      設定が終わったら、<keycap>Enter</keycap>
      を押して設定を保存し、次の画面へ移動してください。</para>

    <sect2 xml:id="bsdinstall-keymap">
      <title>キー配列メニューの選択</title>

      <para>このプロセスが始まると、
	<application>bsdinstall</application> は <xref
	  linkend="bsdinstall-keymap-loading"/>
	のようにキーマップファイルを読み込みます。</para>

      <figure xml:id="bsdinstall-keymap-loading">
	<title>キーマップの読み込み</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-keymap-loading"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>キーマップが読み込まれると、
	<application>bsdinstall</application> は
	<xref linkend="bsdinstall-keymap-10"/> を表示します。
	上下の矢印キーを使って、
	システムのキーボードに最も近いキーマップを選択してください。
	選択を保存するには、<keycap>Enter</keycap> キーを押してください。</para>

      <figure xml:id="bsdinstall-keymap-10">
	<title>キーマップ選択メニュー</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-keymap-10"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <note><para><keycap>Esc</keycap> を押すと、メニューは終了し、
	デフォルトのキーボードマップを使うようになります。
	どのキーボードマップを選べばよいかわからない場合は、
	<guimenuitem>United States of America ISO-8859-1</guimenuitem>
	を選ぶとよいでしょう。</para></note>

      <para>デフォルトとは異なるキーマップを選択した場合には、
	<xref linkend="bsdinstall-keymap-testing"/>
	でキーマップのテストを行い、
	インストールを先に進む前に正しく動くかどうかを確認できます。</para>

      <figure xml:id="bsdinstall-keymap-testing">
	<title>キーマップテストメニュー</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-keymap-testing"/>
	  </imageobject>
	</mediaobject>
      </figure>

    </sect2>

    <sect2 xml:id="bsdinstall-hostname">
      <title>ホスト名の設定</title>

      <para>次の <application>bsdinstall</application> のメニューでは、
	新しくインストールするシステムに与えるホスト名を設定します。</para>

      <figure xml:id="bsdinstall-config-hostname">
	<title>ホスト名の設定</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-config-hostname"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>ネットワーク上でユニークなホスト名を入力してください。
	入力するホスト名は、<systemitem
	  class="fqdomainname">machine3.example.com</systemitem>
	のように完全修飾のホスト名で入力してください。</para>
    </sect2>

    <sect2 xml:id="bsdinstall-components">
      <title>インストールするコンポーネントの設定</title>

      <para>次に、 <application>bsdinstall</application>
	は、インストールするオプションのコンポーネントの選択に移ります。</para>

      <figure xml:id="bsdinstall-config-components">
	<title>インストールするコンポーネントの設定</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-config-components"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>どのコンポーネントをインストールするかは、
	システムの用途と用意されているディスク容量に依存します。
	<firstterm>base system</firstterm> として知られている
	&os; カーネルとユーザランドは、
	常にインストールされます。
	アーキテクチャによっては、表示されないコンポーネントもあります。</para>

      <itemizedlist>

	<listitem>
	  <para><literal>base-dbg</literal> - 
	    デバッグシンボルを有効にしたベースツール
	    (<application>cat</application>,
	    <application>ls</application> や他の多くのツール)。</para>
	</listitem>

	<listitem>
	  <para><literal>kernel-dbg</literal> -
	    デバッグシンボルを有効にしたカーネルおよびモジュール。</para>
	</listitem>

	<listitem>
	  <para><literal>lib32-dbg</literal> -
	    32-bit のアプリケーションを 64-bit 版の &os;
	    で実行する際に必要となる互換ライブラリ
	    (デバッグシンボルは有効)。</para>
	</listitem>

	<listitem>
	  <para><literal>lib32</literal> -
	    32-bit のアプリケーションを 64-bit 版の &os;
	    で実行する際に必要となる互換ライブラリ。</para>
	</listitem>

	<listitem>
	  <para><literal>ports</literal> - &os; 
	    Ports Collection は、
	    サードパーティ製ソフトウェアパッケージのダウンロード、
	    コンパイル、
	    インストールを自動化するように設計されたファイルの集まりです。
	    Ports Collection の使い方については、
	    <xref linkend="ports"/> で説明します。</para>

	  <warning>
	    <para>インストールプログラムは、
	      システムのディスクに十分な空き容量があるかどうかを確認しないので、
	      ハードディスクに十分な容量があるときだけ、
	      このオプションを選択するしてください。
	      &os;&nbsp;9.0 では、Ports Collection が必要とする容量は、
	      約 &ports.size; です。</para>
	  </warning>
	</listitem>

	<listitem>
	  <para><literal>src</literal> - &os;
	    のカーネルおよびユーザランド両方の完全なソースコードです。
	    ほとんどのアプリケーションは必要としませんが、
	    デバイスドライバやカーネルモジュール、
	    Ports Collection
	    のアプリケーションによってはコンパイル時に必要となります。
	    このソースは、&os; そのものの開発に使うこともできます。
	    すべてのソースツリーをインストールするには
	    1&nbsp;GB のディスク容量を必要とします。
	    また、&os; システム全体のコンパイルには、
	    さらに 5&nbsp;GB の容量が必要です。</para>
	</listitem>

	<listitem>
	  <para><literal>tests</literal> - &os; テストスイート。</para>
	</listitem>
      </itemizedlist>
    </sect2>

    <sect2 xml:id="bsdinstall-netinstall">
      <title>ネットワークからのインストール</title>

      <para><xref
	  linkend="bsdinstall-netinstall-notify"/> で示されているメニューは、
	<filename>-bootonly.iso</filename> または
	<filename>-mini-memstick.img</filename>
	からインストールする時のみ表示されます。この
	インストールメディアは、インストールファイルを含んでいません。
	このメニューは、
	ネットワーク経由でインストールファイルをダウンロードする必要があるため、
	ネットワークインタフェースを最初に設定する必要があることを示しています。
	このメニューがインストールのプロセスで表示された場合には、
	<xref linkend="bsdinstall-config-network-dev"/>
	に書かれている手順に従ってください。</para>

      <figure xml:id="bsdinstall-netinstall-notify">
	<title>ネットワークからのインストール</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
		fileref="bsdinstall/bsdinstall-netinstall-files"/>
	  </imageobject>
	</mediaobject>
      </figure>
    </sect2>
  </sect1>

  <sect1 xml:id="bsdinstall-partitioning">
    <title>ディスク領域の割り当て</title>

    <para>次のメニューでは、ディスク領域を割り当てる方法を選択します。</para>

    <figure xml:id="bsdinstall-zfs-partmenu">
      <title>パーティション分割の選択</title>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="bsdinstall/bsdinstall-zfs-partmenu"/>
	</imageobject>
      </mediaobject>
    </figure>

    <para><application>bsdinstall</application>
      では、ディスク領域の割り当てのために
      4 つの方法が用意されています。</para>

    <itemizedlist>
      <listitem>
	<para><literal>Auto (UFS)</literal>
	  によるパーティションの分割では、
	  <literal>UFS</literal>
	  ファイルシステムを使ってディスクパーティションを自動的に分割します。</para>
      </listitem>

      <listitem>
	<para><literal>Manual</literal>
	  によるパーティションの分割は、
	  高度な知識を持つユーザ向けで、
	  メニューオプションからカスタマイズしたパーティションを作成できます。</para>
      </listitem>

      <listitem>
	<para><literal>Shell</literal> では、シェルプロンプトを起動し、
	  高度な知識を持つユーザが、
	  &man.gpart.8;, &man.fdisk.8;, &man.bsdlabel.8;
	  のようなコマンドラインのプログラムを実行して、
	  カスタマイズしたパーティションを作成できます。</para>
      </listitem>

      <listitem>
	<para><literal>Auto (ZFS)</literal>
	  によるパーティションの分割では、
	  root-on-ZFS システムを構築します。
	  GELI 暗号に対応した <firstterm>ブート環境</firstterm>
	  を構築することもできます。</para>
      </listitem>
    </itemizedlist>

    <para>この章では、
      ディスクパーティションをレイアウトする際の検討事項を説明します。
      その後、各パーティションの作成方法について説明します。</para>

   <sect2 xml:id="configtuning-initial">
     <title>パーティションレイアウトのデザイン</title>

      <indexterm><primary>partition layout</primary></indexterm>
      <indexterm>
	<primary><filename>/etc</filename></primary>
      </indexterm>
      <indexterm>
	<primary><filename>/var</filename></primary>
      </indexterm>
      <indexterm>
	<primary><filename>/usr</filename></primary>
      </indexterm>

	<para>ファイルシステムのレイアウトを行う際には、
	  ハードディスクの外周部は内周部よりもデータ転送が速いということを思い出してください。
	  これに従えば、
	  小さくて激しくアクセスされるファイルシステムを外周付近に、
	  <filename>/usr</filename>
	  のようなより大きなパーティションはディスクの内側に配置すべきでしょう。
	  そのため、パーティションを作成する際には、<filename>/</filename>、
	  スワップ、<filename>/var</filename>, <filename>/usr</filename>
	  のような順で作ってゆくのがよいでしょう。</para>

	<para><filename>/var</filename> パーティションのサイズは、
	  あなたが計算機をどのように使おうとしているかを反映します。
	  このパーティションには主としてメールボックスやログファイル、
	  プリンタスプールが置かれます。
	  メールボックスとログファイルは、
	  システムのユーザ数やログの保持期間に依存して予期し得ぬサイズにまで成長する可能性があります。
	  概して、ほとんどのユーザは、<filename>/var</filename>
	  にギガバイト以上の空き容量を必要とはしないでしょう。</para>

      <note>
	<para>時には、たくさんのディスク容量が
	  <filename>/var/tmp</filename> に必要になるときがあります。
	  新しいソフトウェアをインストールする際、
	  package のツールは、package の一時的なコピーを
	  <filename>/var/tmp</filename> 以下に展開します。
	  <filename>/var/tmp</filename>
	  以下に十分なディスク容量が用意されていないと、
	  <application>Firefox</application> や
	  <application>LibreOffice</application> のような、
	  大きなソフトウェア package のインストールが、
	  困難になることがあります。</para>
      </note>

      <para><filename>/usr</filename> パーティションには、
	&os; Ports Collection およびシステムのソースコードを含む、
	システムをサポートするのに必要な多くのファイル群が置かれます。
	このパーティションには、
	少なくとも 2 ギガバイトの容量を用意することをおすすめします。</para>

      <para>パーティションのサイズを考える時、
	必要量を念頭に置いてください。
	別のパーティションには潤沢にスペースが余っているのに、
	あるパーティションでスペースが足らないままというのは、
	フラストレーションがたまるものです。</para>

      <indexterm>
	<primary>swap sizing</primary>
      </indexterm>
      <indexterm>
	<primary>swap partition</primary>
      </indexterm>

      <para>経験からスワップパーティションのサイズは物理メモリ
	(<acronym>RAM</acronym>) の 2 倍というのが一般的です。
	<acronym>RAM</acronym> の少ないシステムでは、
	もっとスワップを増した方が性能がよくなります。
	スワップが少なすぎる設定は、
	あなたが後にメモリを増設したときに問題を起すばかりではなく、
	VM ページスキャニングコードの能率を落します。</para>

      <para>複数の <acronym>SCSI</acronym>
	ディスクや異なるコントローラで操作される複数の
	<acronym>IDE</acronym> ディスクを持つ大規模なシステムでは、
	それぞれのドライブ (4 台まで) にスワップを設定することを推奨します。
	各ドライブのスワップパーティションはほぼ同一サイズであるべきです。
	カーネルは任意のサイズを扱うことができますが、
	内部のデータ構造は最大のスワップパーティションの 4 倍に調節されます。
	スワップパーティションをほぼ同一のサイズにしておくことで、
	カーネルはスワップスペースを最適なかたちでディスクをまたいでストライプさせることができます。
	あなたが通常スワップをたくさん使わないとしても、
	多くのスワップサイズを用意しておくと良いでしょう。
	プログラムが暴走しても再起動させられる前に回復することが容易になります。</para>

	<para>システムを適切にパーティション化することで、
	  小さいが書き込みの激しいパーティションによって引き起こされるフラグメント化を、
	  読み出し専門のパーティションにまで波及させずにすみます。
	  また、書き込みの激しいパーティションをディスクの周辺部に配置することで、
	  <acronym>I/O</acronym> パフォーマンスを増大させることができます。
	  大きなパーティション内の <acronym>I/O</acronym>
	  パフォーマンスもまた必要とされているでしょうが、
	  ディスク周辺部へ移動させたとしても、
	  <filename>/var</filename>
	  を周辺部に移動させることによって大きな効果が得られたのとは対照的に、
	  意味のあるパフォーマンスの増加は見込めないでしょう。</para>
    </sect2>

    <sect2 xml:id="bsdinstall-part-guided">
      <title>UFS を用いた Guided によるパーティションの分割</title>

      <para>この方法を選択すると、
	メニューには利用可能なディスクが表示されます。
	複数のディスクが接続されている場合には、
	&os; をインストールするディスクを選択してください。</para>

      <figure xml:id="bsdinstall-part-guided-disk">
	<title>複数のディスクから選択する</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-part-guided-disk"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>ディスクを選択したら、次のメニューでは、
	ディスクのすべてにインストールを行うか、
	または空き容量にパーティションを作成してインストールを行うかを設定します。
	<guibutton>[&nbsp;Entire&nbsp;Disk&nbsp;]</guibutton> を選択すると、
	一般的なパーティションレイアウトが自動的に作成されます。
	<guibutton>[&nbsp;Partition&nbsp;]</guibutton> を選択すると、
	ディスクの使用していない領域にパーティションレイアウトを作成します。</para>

      <figure xml:id="bsdinstall-part-entire-part">
	<title>Entire Disk または Partition の選択</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-part-entire-part"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><guibutton>[&nbsp;Entire&nbsp;Disk&nbsp;]</guibutton>
	を選択すると、
	<application>bsdinstall</application> は、
	ディスクの内容が消去されることを確認するダイアログを表示します。</para>

      <figure xml:id="bsdinstall-ufs-warning">
	<title>確認</title>

        <mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-ufs-warning"/>
	  </imageobject>
        </mediaobject>
      </figure>

      <para>次のメニューでは、
	パーティションスキームタイプの一覧が表示されます。
	amd64 コンピュータでは、通常 GPT
	が最も適切な選択となります。
	<acronym>GPT</acronym> に対応していないような古いコンピュータでは、
	<acronym>MBR</acronym> を使う必要があります。
	他のパーティションスキームは、使うことがまれであったり、
	古いコンピュータで用いられるものです。
	<xref linkend="partition-schemes"/> に詳細があります。</para>

      <figure xml:id="bsdinstall-ufs-scheme">
	<title>パーティションスキームの選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-part-manual-partscheme"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>パーティションのレイアウトを作成したら、
	インストールの条件を満たしているかどうかを深く確認してください。
	<guibutton>[&nbsp;Revert&nbsp;]</guibutton> を選択すると、
	パーティションをオリジナルの値にリセットします。
	また、<guibutton>[&nbsp;Auto&nbsp;]</guibutton> を選択すると、
	&os; パーティションを自動的に作成します。
	パーティションを手動で作成、変更、削除することもできます。
	正しくパーティションを作成出来たら、
	<guibutton>[&nbsp;Finish&nbsp;]</guibutton> を選択し、
	インストールを進めてください。</para>

      <figure xml:id="bsdinstall-part-review">
	<title>作成されたパーティションの確認</title>
	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-part-review"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>ディスクを一度設定すると、次のメニューは、
	選択したハードドライブをフォーマットする前に、
	設定を変更する最後のチャンスです。
	もし変更が必要であれば、
	<guibutton>[&nbsp;Back&nbsp;]</guibutton>
	を選択してメインのパーティションエディタまで戻ってください。
	<guibutton>[&nbsp;Revert&nbsp;&amp;&nbsp;Exit&nbsp;]</guibutton>
	を選択すると、
	ハードドライブへの変更なしにインストールを終了します。
	インストールプロセスを開始するのには、
	<guibutton>[&nbsp;Commit&nbsp;]</guibutton>
	を選択してしてください。</para>

      <figure xml:id="bsdinstall-ufs-final-confirmation">
	<title>最後の確認</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-final-confirmation"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><xref linkend="bsdinstall-fetching-distribution"/>
	に進んで、インストールプロセスを続けてください。</para>
    </sect2>

    <sect2 xml:id="bsdinstall-part-manual">
      <title>Manual によるパーティションの分割</title>

      <para>この方法を選択すると、
	パーティションエディタが起動します。</para>

      <figure xml:id="bsdinstall-part-manual-create">
	<title>Manual によるパーティションの分割</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-part-manual-create"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>インストール先のドライブ
	(この例では <filename>ada0</filename>) を選び、
	<guibutton>[&nbsp;Create&nbsp;]</guibutton> を選択すると、
	利用可能なパーティションスキームの一覧が表示されます。</para>

      <figure xml:id="bsdinstall-part-manual-partscheme">
	<title>手動でパーティションを作成する</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-part-manual-partscheme"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>&arch.amd64; コンピュータでは、通常 <acronym>GPT</acronym>
	が最も適切な選択となります。
	<acronym>GPT</acronym> に対応していないような古いコンピュータでは、
	<acronym>MBR</acronym> を使う必要があります。
	他のパーティションスキームは、使うことがまれであったり、
	古いコンピュータで用いられるものです。</para>

      <table xml:id="partition-schemes" frame="none" rowsep="1" pgwide="1">
	<title>パーティションスキーム</title>

	<tgroup cols="2" align="left">
	  <thead>
	    <row>
	      <entry align="left">省略形</entry>
	      <entry align="left">説明</entry>
	    </row>
	  </thead>

	  <tbody>
	    <row>
	      <entry>APM</entry>
	      <entry>&powerpc; で使われている Apple Partition Map</entry>
	    </row>

	    <row>
	      <entry>BSD</entry>
	      <entry><acronym>MBR</acronym> を用いない
	      <acronym>BSD</acronym> ラベル。
	      <acronym>BSD</acronym>
	      以外のディスクユーティリティは認識しないため、しばしば
	      <firstterm>dangerously dedicated mode</firstterm>
	      と呼ばれます。</entry>
	    </row>

	    <row>
	      <entry>GPT</entry>
	      <entry>GUID Partition Table (<link
		  xlink:href="http://en.wikipedia.org/wiki/GUID_Partition_Table">http://en.wikipedia.org/wiki/GUID_Partition_Table</link>)</entry>
	    </row>

	    <row>
	      <entry>MBR</entry>
	      <entry>Master Boot Record (<link
		  xlink:href="http://en.wikipedia.org/wiki/Master_boot_record">http://en.wikipedia.org/wiki/Master_boot_record</link>)</entry>
	    </row>

	    <row>
	      <entry>VTOC8</entry>
	      <entry>Volume Table Of Contents。
	      Sun SPARC64 および UltraSPARC コンピュータで使われます。</entry>
	    </row>
	  </tbody>
	</tgroup>
      </table>

      <para>パーティションスキームを選択して作成した後で、
	もう一度 <guibutton>[&nbsp;Create&nbsp;]</guibutton> を選択すると、
	パーティションが作成されます。<keycap>Tab</keycap>
        キーを使ってカーソルをフィールド間で移動できます。</para>

      <figure xml:id="bsdinstall-part-manual-addpart">
	<title>手動でパーティションを作成する</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-part-manual-addpart"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>標準の &os; <acronym>GPT</acronym> のインストールでは、
	少なくとも 3 つのパーティションが使われます。</para>

      <itemizedlist>
	<listitem>
	  <para><literal>freebsd-boot</literal> - &os;
	    ブートコードを含んでいます。</para>
	</listitem>

	<listitem>
	  <para><literal>freebsd-ufs</literal> - &os;
	    <acronym>UFS</acronym> ファイルシステム。</para>
	</listitem>

	<listitem>
	  <para><literal>freebsd-zfs</literal> -
	    &os; <acronym>ZFS</acronym>	ファイルシステム。
	    詳細については、
	    (<link xlink:href="&url.books.handbook.en;/zfs.html">
	      The Z File System (ZFS)</link><!-- <xref
	      linkend="zfs"/>-->) をご覧ください。</para>
	</listitem>

	<listitem>
	  <para><literal>freebsd-swap</literal> - &os;
	    スワップ空間。</para>
	</listitem>
      </itemizedlist>

      <para>利用可能な <acronym>GPT</acronym>
	パーティションタイプについては、&man.gpart.8;
	をご覧ください。</para>

      <para>複数のファイルシステムのパーティションを作成できます。
	<filename>/</filename>, <filename>/var</filename>,
	<filename>/tmp</filename> そして <filename>/usr</filename>
	といった伝統的なパーティション分割のレイアウトを好む人もいます。
	レイアウトの例が <xref
	  linkend="bsdinstall-part-manual-splitfs"/> にあります。</para>

      <para><literal>Size</literal> には、
	<emphasis>K</emphasis> (キロバイト)、
	<emphasis>M</emphasis> (メガバイト)、
	<emphasis>G</emphasis> (ギガバイト)
	といった通常の省略形を使用出来ます。</para>

      <tip>
	<para>セクタを適切に配置することで、
	  最良のパフォーマンスを得ることができます。
	  また、パーティションサイズを 4K バイトの偶数倍にすると、
	  512 バイトまたは 4K バイトのセクタでドライブが配置しやすくなります。 一般的に、
	  4K の偶数倍の場所からパーティションが開始するように設定する簡単な方法は、
	  1M または 1G の偶数倍のパーティションサイズを用いることです。
	  ただし、例外があります。
	  <emphasis>freebsd-boot</emphasis> パーティションは、
	  ブートコードの制限により 512K 以下である必要があります。</para>
      </tip>

      <para>ファイルシステムを持つパーティションでは、
	<literal>Mountpoint</literal> が必要となります。
	1 つの <acronym>UFS</acronym> パーティションだけを作成したのであれば、
	マウントポイントは <filename>/</filename> となります。</para>

      <para><literal>Label</literal>
	は作成したパーティションを認識するための名前です。
	ドライブ名や番号は、
	ドライブが別のコントローラやポートに接続されると変わることがありますが、
	パーティションラベルは変わりません。
	<filename>/etc/fstab</filename> のようなファイルの中で、
	ドライブ名やパーティション番号ではなく、ラベルを参照することにより、
	システムがハードウェアの変更に対して、より寛容になります。
	<acronym>GPT</acronym> ラベルは、
	ディスクが接続されると <filename>/dev/gpt/</filename>
	に現れます。他のパーティションスキームでは別のラベルとなり、
	<filename>/dev/</filename>
	以下の異なるディレクトリにラベルが現れます。</para>

      <tip>
	<para>名前の衝突を避けるため、
	  各パーティションには、一意的な名前使ってください。
	  コンピュータ名、使用、位置情報を表す単語をラベルに追加できます。
	  たとえば、<literal>lab</literal> という名前のコンピュータの
	  <acronym>UFS</acronym> の root パーティションには、
	  <literal>labroot</literal> または
	  <literal>rootfs-lab</literal> といった名前を使ってください。</para>
      </tip>

      <example xml:id="bsdinstall-part-manual-splitfs">
	<title>伝統的なファイルシステムのパーティションを作成する。</title>

	<para>伝統的なパーティションレイアウト
	  (<filename>/</filename>, <filename>/var</filename>,
	  <filename>/tmp</filename> および <filename>/usr</filename>
	  ディレクトリが各パーティションの別のファイルシステム)
	  を作成するには、
	  <acronym>GPT</acronym> パーティションスキームを作成し、
	  その後、示されているようにパーティションを作成してください。
	  示されているパーティションサイズは 20G のディスク用です。
	  ディスクにより多くの容量があれば、swap または
	  <filename>/var</filename>
	  パーティションを大きく取ると良いでしょう。
	  ここで示されているラベルには、
	  <literal>example</literal> を意味する
	  <literal>ex</literal> が付けられていますが、
	  実際には上で説明したように、
	  これとは別のユニークなラベルをつけてください。</para>

	<para>&os; の <filename>gptboot</filename> は、
	  デフォルトでは最初に見つかった
	  <acronym>UFS</acronym> パーティションが、
	  <filename>/</filename> パーティションであることを前提としています。</para>

	<informaltable frame="none">
	  <tgroup cols="4">
	    <thead>
	      <row>
		<entry>パーティションタイプ</entry>
		<entry>サイズ</entry>
		<entry>マウントポイント</entry>
		<entry>ラベル</entry>
	      </row>
	    </thead>

	    <tbody>
	      <row>
		<entry><literal>freebsd-boot</literal></entry>
		<entry><literal>512K</literal></entry>
	      </row>

	      <row>
		<entry><literal>freebsd-ufs</literal></entry>
		<entry><literal>2G</literal></entry>
		<entry><filename>/</filename></entry>
		<entry><literal>exrootfs</literal></entry>
	      </row>

	      <row>
		<entry><literal>freebsd-swap</literal></entry>
		<entry><literal>4G</literal></entry>
		<entry></entry>
		<entry><literal>exswap</literal></entry>
	      </row>

	      <row>
		<entry><literal>freebsd-ufs</literal></entry>
		<entry><literal>2G</literal></entry>
		<entry><filename>/var</filename></entry>
		<entry><literal>exvarfs</literal></entry>
	      </row>

	      <row>
		<entry><literal>freebsd-ufs</literal></entry>
		<entry><literal>1G</literal></entry>
		<entry><filename>/tmp</filename></entry>
		<entry><literal>extmpfs</literal></entry>
	      </row>

	      <row>
		<entry><literal>freebsd-ufs</literal></entry>
		<entry>デフォルト (ディスクの残りのすべての容量)</entry>
		<entry><filename>/usr</filename></entry>
		<entry><literal>exusrfs</literal></entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>
      </example>

      <para>カスタムパーティションを作成したら、
	<guibutton>[&nbsp;Finish&nbsp;]</guibutton> を選択して
	<xref linkend="bsdinstall-fetching-distribution"/>
	に進み、インストールを先に進めてください。</para>
    </sect2>

    <sect2 xml:id="bsdinstall-part-zfs">
      <title>Root-on-ZFS を用いた Guided によるパーティションの作成</title>

      <para>このパーティションの分割モードは、
	ディスクのすべての領域に対して機能するので、
	ディスク上にあるすべての内容が消去されます。
	メインの <acronym>ZFS</acronym> 設定メニューには、
	プールの作成をコントロールする数多くのオプションが用意されています。</para>

      <figure xml:id="bsdinstall-zfs-menu">
	<title><acronym>ZFS</acronym> パーティションメニュー</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-zfs-menu"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>このメニューで選択できるオプションは以下の通りです。</para>

    <itemizedlist>
      <listitem>
	<para><literal>Install</literal> -
	  選択したオプションでインストールを進めます。</para>
      </listitem>

      <listitem>
	<para><literal>Pool Type/Disks</literal> -
	  プールを構成する <literal>Pool Type</literal>
	  およびディスクについて設定します。
	  <acronym>ZFS</acronym> の自動インストーラは、
	  現時点で、ストライプモードを除き、
	  単一のトップレベルの仮想デバイスの作成のみに対応しています。
	  より複雑なプールを作成するには、
	  <xref linkend="bsdinstall-part-shell"/>
	  で説明されている方法で作成してください。</para>
      </listitem>

      <listitem>
	<para><literal>Rescan Devices</literal> -
	  利用可能なディスクの一覧を再表示します。</para>
      </listitem>

      <listitem>
	<para><literal>Disk Info</literal> - Disk Info
	  メニューを使って各ディスクを調べることができます。
	  パーティションテーブルやそれ以外のデバイスモデルナンバーおよびシリアルナンバーといった情報も、
	  可能であれば調べることができます。</para>
      </listitem>

      <listitem>
	<para><literal>Pool Name</literal> - pool の名前を設定します。
	  デフォルトの名前は <emphasis>zroot</emphasis> です。</para>
      </listitem>

      <listitem>
	<para><literal>Force 4K Sectors?</literal> -
	  4K セクタを使用するようにします。
	  インストーラは、デフォルトで 4K
	  の境界に整列するようにパーティションを自動的に作成し、
	  ZFS が 4K セクタを使用するようにします。
	  これは 512 バイトセクタのディスクでも安全で、
	  512 バイトのディスク上に作成されたプールが将来的に
	  4K セクタのディスクを追加できるようにしておくことには、
	  ストレージ容量の追加や壊れたディスクの交換時に恩恵があります。
	  有効にするか無効にするかを選択して
	  <keycap>Enter</keycap> キーを押してください。</para>
      </listitem>

      <listitem>
	<para><literal>Encrypt Disks?</literal> -
	  <acronym>GELI</acronym> を使ってディスクを暗号化できます。
	  ディスクの暗号化の詳細については、
	  <link xlink:href="&url.books.handbook.en;/disks-encrypting.html#disks-encrypting-geli">geli によるディスクの暗号化</link>
	  <!-- <xref linkend="disks-encrypting-geli"/> -->
	  をご覧ください。
	  <keycap>Enter</keycap> キーを押して、
	  暗号化を有効にするか無効にするかを選択してください。</para>
      </listitem>

      <listitem>
	<para><literal>Partition Scheme</literal> -
	  パーティションスキームを選択します。
	  ほとんどの場合において、GPT が推奨されます。
	  別のスキームを選択する場合には、
	  <keycap>Enter</keycap> キーを押してください。</para>
      </listitem>

      <listitem>
	<para><literal>Swap Size</literal> - スワップ容量を設定します。</para>
      </listitem>

      <listitem>
	<para><literal>Mirror Swap?</literal> -
	  スワップ領域をディスク間でミラー化します。
	  スワップ領域をミラー化すると、クラッシュダンプを取得できないので、
	  注意してください。
	  <keycap>Enter</keycap>
	  キーを押して有効/無効を設定してください。</para>
      </listitem>

      <listitem>
	<para><literal>Encrypt Swap?</literal> - スワップ領域を暗号化します。
	  システムの起動時に一時キーをとともにスワップ領域を暗号化し、
	  再起動時にキーは破棄されます。
	  <keycap>Enter</keycap>
	  キーを押して有効/無効を設定してください。
	  詳細については、
	  <link xlink:href="&url.books.handbook.en;/swap-encrypting.html#disks-encrypting-geli">swap 領域の暗号化</link>
	  を参照してください。</para>
      </listitem>
    </itemizedlist>

      <para><keycap>T</keycap> を選択して、<literal>Pool Type</literal>
	およびプールに対応するディスクを選択してください。</para>

      <figure xml:id="bsdinstall-zfs-vdev_type">
	<title><acronym>ZFS</acronym> プールタイプ</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-zfs-vdev_type"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>このメニューで選択可能な <literal>Pool Type</literal>
	は以下の通りです。</para>

    <itemizedlist>
      <listitem>
	<para><literal>stripe</literal> - ストライピングでは、
	  接続されているすべてのデバイスの最大容量を使用できます。
	  ただし、冗長性はありません。
	  一つのディスクが壊れるだけでプールにあるデータは失われてしまい、
	  取り返しがつきません。</para>
      </listitem>
      <listitem>
	<para><literal>mirror</literal> -
	  ミラーリングは各ディスク上にあるすべてのデータの完全なコピーを保存します。
	  ミラーリングでは、並列にすべてのディスクからデータを読むため、
	  読み込みのパフォーマンスが向上します。
	  書き込みのパフォーマンスは、
	  データが並列にすべてのディスクに書き込まれるため、遅くなります。
	  1 つを除くすべてのディスクが壊れることを許容します。
	  このオプションを選択するには、
	  少なくとも 2 つのディスクを必要とします。</para>
      </listitem>
      <listitem>
	<para><literal>raid10</literal> - ストライピングミラー。
	  最も効率は良いですが、ストレージ容量は少なくなります。
	  偶数のディスクが必要で、
	  少なくとも 4 つのディスクが必要です。</para>
      </listitem>
      <listitem>
	<para><literal>raidz1</literal> - シングルパリティの RAID。
	  1 台のディスクの故障に耐えられます。
	  少なくとも 3 つのディスクが必要です。</para>
      </listitem>
      <listitem>
	<para><literal>raidz2</literal> - ダブルパリティの RAID。
	  同時に 2 台のディスクの故障に耐えられます。
	  少なくとも 4 つのディスクが必要です。</para>
      </listitem>
      <listitem>
	<para><literal>raidz3</literal> - トリプルパリティの RAID。
	  同時に 3 台のディスクの故障に耐えられます。
	  少なくとも 5 つのディスクが必要です。</para>
      </listitem>
    </itemizedlist>

      <para><literal>Pool Type</literal> を選択したら、
	利用可能なディスクの一覧が表示されます。
	その後、プールを構成するディスクを、1 つまたは複数選択してください。
	十分なディスクが選択されているかどうかについて検証が行われます。
	もし、問題があるようでしたら、<guibutton>&lt;Change
	Selection&gt;</guibutton> を選択して、ディスクの一覧に戻ってください。
	もしくは、
	<guibutton>&lt;Back&gt;</guibutton> を選択して、
	<literal>Pool Type</literal> に戻ってください。</para>

      <figure xml:id="bsdinstall-zfs-disk_select">
	<title>ディスクの選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-zfs-disk_select"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <figure xml:id="bsdinstall-zfs-vdev_invalid">
	<title>問題のある選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-zfs-vdev_invalid"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>この一覧の中に抜けているディスクがある時や、
	インストーラが立ち上がった後にディスクを接続した場合に、
	最新の利用可能なディスクの一覧を見るには、
	<guibutton>- Rescan Devices</guibutton> を選択してください。</para>

      <figure xml:id="bsdinstall-zfs-rescan-devices">
	<title>Rescan Devices</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-zfs-rescan-devices"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>アクシデントで間違ったディスクを削除してしまわないように、
	<guibutton>- Disk Info</guibutton> メニュー選択して、
	各ディスクのパーティションテーブル、および、
	デバイスモデル番号およびシリアル番号などのさまざまな情報を確認してください。</para>

      <figure xml:id="bsdinstall-zfs-disk_info">
	<title>ディスクの解析</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-zfs-disk_info"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><keycap>N</keycap> を選択して、
	<literal>Pool Name</literal> を設定してください。
	希望する名前を入力後、
	<guibutton>&lt;OK&gt;</guibutton> を選択して確定するか、
	<guibutton>&lt;Cancel&gt;</guibutton> を押して、
	デフォルト名のままでメインメニューに戻ってください。</para>

      <figure xml:id="bsdinstall-zfs-pool-name">
	<title>Pool Name</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-zfs-pool-name"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><keycap>S</keycap> を選択してスワップの容量を設定してください。
	必要なスワップ容量を入力し、
	<guibutton>&lt;OK&gt;</guibutton> を押して確定するか、
	もしくは
	<guibutton>&lt;Cancel&gt;</guibutton> を押して、
	デフォルトの容量のまま、メインメニューに戻ってください。</para>

      <figure xml:id="bsdinstall-zfs-swap-amount">
	<title>Swap 容量</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-zfs-swap-amount"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>すべてのオプションに希望する値を設定したら、
	メニューの上部にある <guibutton>&gt;&gt;&gt;&nbsp;Install</guibutton>
	オプションを選択してください。
	インストーラは、<acronym>ZFS</acronym>
	プールを作成するための最終確認を行います。
	これは、選択したドライブの内容が壊れることをキャンセルする最後の確認の場です。</para>

      <figure xml:id="bsdinstall-zfs-warning">
	<title>最終確認</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-zfs-warning"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><acronym>GELI</acronym> ディスク暗号化を有効にしていたら、
	ディスクを暗号化するために用いるパスフレーズを 2
	度求められます。その後、暗号の初期化が開始します。</para>

      <figure xml:id="bsdinstall-zfs-geli_password">
	<title>ディスク暗号化パスワード</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-zfs-geli_password"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <figure xml:id="bsdinstall-zfs-init-encription">
	<title>暗号の初期化</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-zfs-init-encription"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>その後のインストールの過程は、通常通りに進みます。
	インストールを進めるには、
	<xref linkend="bsdinstall-fetching-distribution"/>
	に進んでください。</para>

    </sect2>

    <sect2 xml:id="bsdinstall-part-shell">
      <title>シェルモードによるパーティションの作成</title>

      <para>高度なインストールを行うには、<application>bsdinstall</application>
	が提供するパーティション分割のメニューは柔軟性にかけることがあります。
	高度な技術を持つユーザは、パーティションメニューで      
	<guibutton>Shell</guibutton> オプションを選択することで、
	手動でドライブを分割して、ファイルシステムを作成し、
	<filename>/tmp/bsdinstall_etc/fstab</filename> を作成し、
	<filename>/mnt</filename>
	以下にファイルシステムをマウントできます。
	以上を実行したら、
	<command>exit</command> を実行して
	<application>bsdinstall</application> に戻り、
	インストールを続けてください。</para>
    </sect2>
  </sect1>

  <sect1 xml:id="bsdinstall-fetching-distribution">
    <title>配布ファイルのダウンロード</title>

    <para>インストールにかかる時間は、どのディストリビューションを選んだか、
      どのインストールメディアを使ったか、
      そしてコンピュータの速度にも依存します。
      進行状況を表すメッセージが逐次表示されます。</para>

    <para>まず最初に、インストーラは選択されているディスクをフォーマットし、
      パーティションを初期化します。
      <literal>bootonly media</literal> または
      <literal>mini memstick</literal> メディアを用いたインストールでは、
      選択されたコンポーネントがダウンロードされます。</para>

    <figure xml:id="bsdinstall-distfile-fetching">
      <title>配布ファイルのダウンロード</title>
      <mediaobject>
	<imageobject>
	  <imagedata
	    fileref="bsdinstall/bsdinstall-distfile-fetching"/>
	</imageobject>
      </mediaobject>
    </figure>

    <para>次に、ダウンロードの際にエラーが含まれなかったか、
      インストールメディアからの読み取り中に読み間違いが起きなかったかどうか等、
      配布ファイルの完全性の検証が行われます。</para>

    <figure xml:id="bsdinstall-distfile-verify">
      <title>配布ファイルの検証</title>
      <mediaobject>
	<imageobject>
	  <imagedata
	    fileref="bsdinstall/bsdinstall-distfile-verifying"/>
	</imageobject>
      </mediaobject>
    </figure>

    <para>最後に、検証された配布ファイルがディスクへ展開されます。</para>

    <figure xml:id="bsdinstall-distfile-extract">
      <title>配布ファイルの展開</title>
      <mediaobject>
	<imageobject>
	  <imagedata
	    fileref="bsdinstall/bsdinstall-distfile-extracting"/>
	</imageobject>
      </mediaobject>
    </figure>

    <para>必要な配布ファイルがすべて展開されると、
      <application>bsdinstall</application> は、
      インストール後の設定画面を表示します。
      利用可能なインストール後のオプションについては次の章で説明します。</para>
  </sect1>

  <sect1 xml:id="bsdinstall-post">
    <title>アカウント、タイムゾーン、
      サービスおよびセキュリティオプションの設定</title>

    <sect2 xml:id="bsdinstall-post-root">
      <title>
	<systemitem class="username">root</systemitem>
	パスワードの設定</title>

      <para>最初に <systemitem class="username">root</systemitem>
	のパスワードを設定する必要があります。
	パスワードを入力している際には、
	入力している文字は画面に表示されません。
	パスワードの入力後、もう一度入力する必要があります。
	これは入力ミスを防ぐためです。</para>

      <figure xml:id="bsdinstall-post-set-root-passwd">
	<title><systemitem
	    class="username">root</systemitem> パスワードの設定</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-post-root-passwd"/>
	  </imageobject>
	</mediaobject>
      </figure>
    </sect2>

    <sect2 xml:id="bsdinstall-timezone">
      <title>タイムゾーンの設定</title>

      <para>次のメニューでは、地域、国、タイムゾーンを指定します。
	使用しているシステムのタイムゾーンを設定することで、
	夏時間などの地域による時刻の違いが自動的に調整され、
	タイムゾーンに関連した機能が適切に取り扱われます。</para>

      <para>ここでの例は、
	欧州スペインのメインランドタイムゾーンにあるコンピュータに対するものです。
	実際の地理的位置に対応するタイムゾーンを設定してください。</para>

      <figure xml:id="bsdinstall-timezone-region">
	<title>地域の選択</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-timezone-region"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>矢印キーを使って、適切な地域を選択し、
	<keycap>Enter</keycap> を押してください。</para>

      <figure xml:id="bsdinstall-timezone-country">
	<title>国名の選択</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-timezone-country"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>矢印キーを使って、適切に国名を選び、
	<keycap>Enter</keycap> を押してください。</para>

      <figure xml:id="bsdinstall-timezone-zone">
	<title>タイムゾーンの選択</title>
	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-timezone-zone"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>矢印キーを使って適切なタイムゾーンを選択し、
	<keycap>Enter</keycap> を押してください。</para>

      <figure xml:id="bsdinstall-timezone-confirmation">
	<title>タイムゾーンの確定</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-timezone-confirm"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>タイムゾーンの省略形が正しいかどうかを確認してください。</para>

      <figure xml:id="bsdinstall-timezone-date">
	<title>日付の設定</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-timezone-date"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>矢印キーを使って適切な日付を選択したら、
	<guibutton>[&nbsp;Set&nbsp;Date&nbsp;]</guibutton>
	を押してください。
	<guibutton>[&nbsp;Skip&nbsp;]</guibutton>
	を押すと日付の設定をスキップできます。</para>

      <figure xml:id="bsdinstall-timezone-time">
	<title>時刻の設定</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-timezone-time"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>矢印キーを使って適切な時刻に設定したら、
	<guibutton>[&nbsp;Set&nbsp;Time&nbsp;]</guibutton>
	を押してください。
	<guibutton>[&nbsp;Skip&nbsp;]</guibutton>
	を押すと時刻の設定をスキップできます。</para>
    </sect2>

    <sect2 xml:id="bsdinstall-sysconf">
      <title>サービスを有効にする</title>

      <para>次のメニューでは、システムが起動した時に、
	起動するシステムサービスを設定します。
	これらのサービスはすべてオプションです。
	システムの機能として必要なサービスだけを起動するようにしてください。</para>

      <figure xml:id="bsdinstall-config-serv">
	<title>追加で有効にするサービスの選択</title>
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-config-services"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>このメニューで有効にできるサービスは以下の通りです。</para>

      <itemizedlist>
	<listitem>
	  <para><literal>local_unbound</literal> - 
	    DNS のローカル unbound を有効にします。
	    この設定はベースシステムの unbound に対するもので、
	    ローカルキャッシュフォワードリゾルバとしての利用のみを想定しています。
	    ネットワーク全体のリゾルバを設定したいのであれば、
	    <package>dns/unbound</package> をインストールしてください。</para>
	</listitem>

	<listitem>
	  <para><literal>sshd</literal> - セキュアシェル
	    (<acronym>SSH</acronym>) デーモンは、
	    暗号化された接続上でリモートアクセスするために使われます。
	    システムがリモートログインを必要とする場合のみ、
	    このサービスを有効にしてください。</para>
	</listitem>

	<listitem>
	  <para><literal>moused</literal> - システムのコンソールで、
	    マウスを利用する時に、このサービスを有効にしてください。</para>
	</listitem>

	<listitem>
	  <para><literal>ntpdate</literal> -
	    起動時の自動時刻同期を有効にします。
	    この機能は、現在 &man.ntpd.8; デーモンでも利用できます。
	    猶予期間が経過したら、&man.ntpdate.8;
	    ユーティリティはその役目を終える予定です。</para>
	</listitem>

	<listitem>
	  <para><literal>ntpd</literal> - 自動時刻同期のための
	    The Network Time Protocol
	    (<acronym>NTP</acronym>) デーモン。
	    ネットワーク上に、
	    &windows;, Kerberos または <acronym>LDAP</acronym> 
	    サーバがあるときには、このサービスを有効にしてください。</para>
	</listitem>

	<listitem>
	  <para><literal>powerd</literal> -
	    電源の管理およびエネルギーを節約するための電源コントロールユーティリティ</para>
	</listitem>

	<listitem>
	  <para><literal>dumpdev</literal> -
	    システムのデバッグを行う上で、
	    クラッシュダンプを有効にすることは有用です。
	    可能であればクラッシュダンプを有効にすると良いでしょう。</para>
	</listitem>
      </itemizedlist>
    </sect2>

    <sect2 xml:id="bsdinstall-hardening">
      <title>セキュリティを強化するオプションを有効にする</title>

      <para>次のメニューでは、
	有効にするセキュリティオプションを設定します。
	すべてはオプションですが、有効にすることが推奨されます。</para>

      <figure xml:id="bsdinstall-hardening-options">
	<title>セキュリティを強化するオプションの設定</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-hardening"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>このメニューで有効にできるのは、以下のオプションです。</para>

      <itemizedlist>
	<listitem>
	  <para><literal>hide_uids</literal> -
	    情報漏洩防止のため、特権のないユーザが、他のユーザ (UID)
	    により実行されているプロセスを見れないように、
	    他のユーザが実行しているプロセスを隠します。</para>
	</listitem>

	<listitem>
	  <para><literal>hide_gids</literal> -
	    情報漏洩防止のため、特権のないユーザが、他のグループ (GID)
	    により実行されているプロセスを見れないように、
	    他のユーザが実行しているプロセスを隠します。</para>
	</listitem>

	<listitem>
	  <para><literal>hide_jail</literal> -
	    特権のないユーザが、jail
	    の中で実行されているプロセスを見れないように、
	    jail で実行中のプロセスを隠します。</para>
	</listitem>

	<listitem>
	  <para><literal>read_msgbuf</literal> -
	    権限のないユーザが、&man.dmesg.8;
	    を使ってカーネルログバッファのメッセージを見ることで、
	    カーネルメッセージバッファを読むことを無効にします。 
	  </para>
	</listitem>

	<listitem>
	  <para><literal>proc_debug</literal> -
	    ptrace() および ktrace() といった procfs 機能を含む、
	    さまざまな特権のないプロセス間のデバッキングサービスを、
	    特権のないユーザが無効にしないように、
	    プロセスデバッキング機能を無効にします。
	    このオプションによって、PHP
	    などのスクリプト言語に対する組み込みのデバッキング機能と同様に、
	    たとえば &man.lldb.1;, &man.truss.1;, &man.procstat.1;
	    などの特権のないユーザによるデバッキングツールも無効になります。</para>
	</listitem>

	<listitem>
	  <para><literal>random_pid</literal> - 新しく生成されるプロセスの
	    PID をランダム化します。</para>
	</listitem>

	<listitem>
	  <para><literal>clear_tmp</literal> - システムの起動時に
	    <filename>/tmp</filename> を空にします。</para>
	</listitem>

	<listitem>
	  <para><literal>disable_syslogd</literal> -
	    <application>syslogd</application> ネットワークソケットを閉じます。
	    デフォルトでは、&os; は <application>syslogd</application> を
	    <command>-s</command> を使った安全な方法で実行します。
	    これは、外からのポート 514 に対する UDP リクエストを待機しません。
	    このオプションを有効にすると、
	    <application>syslogd</application> を
	    <command>-ss</command> フラグで実行します。
	    このフラグにより、<application>syslogd</application>
	    は空いているどのポートからも受け付けません。
	    詳細は、&man.syslogd.8; をご覧ください。</para>
	</listitem>

	<listitem>
	  <para><literal>disable_sendmail</literal> -
	    sendmail MTA を無効にします。</para>
	</listitem>

	<listitem>
	  <para><literal>secure_console</literal> -
	    このオプションを有効にすると、シングルユーザモードに入る際に、
	    プロンプトに対して <systemitem class="username">root</systemitem>
	    パスワードが必要となります。</para>
	</listitem>

	<listitem>
	  <para><literal>disable_ddtrace</literal> -
	    &dtrace; は、
	    実行中のカーネルに実際に影響を及ぼすモードで実行できます。
	    破壊的なアクションは、明示的に有効にしない限りは利用できません。
	    破壊的なアクションを実行できるようにするには、
	    <command>-w</command> を使って &dtrace; を実行する必要があります。
	    詳細については &man.dtrace.1; をご覧ください。</para>
	</listitem>
      </itemizedlist>
    </sect2>

    <sect2 xml:id="bsdinstall-addusers">
      <title>ユーザの追加</title>

      <para>次のメニューでは、少なくとも一人のユーザを追加してください。
	システムには <systemitem class="username">root</systemitem>
	ではなく、ユーザアカウントでログインすることが推奨されています。
	<systemitem class="username">root</systemitem>
	権限でログインすると、実行に対して制限がなく、また、保護されません。
	通常のユーザでログインすることにより、
	安全でセキュリティ的に危険が少なくなります。</para>

      <para><guibutton>[&nbsp;Yes&nbsp;]</guibutton> を選択し、
	新しいユーザを追加してください。</para>

      <figure xml:id="bsdinstall-add-user1">
	<title>新しいユーザのアカウントの作成</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-adduser1"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>プロンプトに従い、
	ユーザアカウントの作成で必要となる情報を入力してください。
	<xref
	  linkend="bsdinstall-add-user2"/> で示されている例では、<systemitem
	  class="username">asample</systemitem> ユーザアカウントを作成します。</para>

      <figure xml:id="bsdinstall-add-user2">
	<title>ユーザ情報の入力</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-adduser2"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>以下は、入力情報のまとめです。</para>
      
      <itemizedlist>
	<listitem>
	  <para><literal>Username</literal> -
	    ログイン時のユーザ名を入力します。一般的な慣習では、
	    ファーストネームの最初の文字とラストネームを、
	    ユーザ名がシステムで一意的になる長さで組み合わせます。
	    ユーザ名は、大文字と小文字を区別し、
	    空白を含んではいけません。</para>
	</listitem>

	<listitem>
	  <para><literal>Full name</literal> - ユーザのフルネーム。
	    空白を含むことは可能です。
	    また、この情報はユーザアカウントの説明の記述に使われます。</para>
	</listitem>

	<listitem>
	  <para><literal>Uid</literal> - ユーザ <acronym>ID</acronym> 番号。
	    通常は、システムが自動的に割り当てるように、
	    空欄のままにします。</para>
	</listitem>

	<listitem>
	  <para><literal>Login group</literal> -
	    新しいユーザのログイングループ。
	    空欄のままにすると、デフォルトに割り当てられます</para>
	</listitem>

	<listitem>
	  <para><literal>Invite <replaceable>user</replaceable> into
	    other groups?</literal> -
	    ユーザを別のグループのメンバーとして追加するかどうか。
	    ユーザが管理者としてのアクセス必要であれば、
	    ここで <literal>wheel</literal> を入力してください。</para>
	</listitem>

	<listitem>
	  <para><literal>Login class</literal> -
	    空欄にするとデフォルトの設定になります。</para>
	</listitem>

	<listitem>
	  <para><literal>Shell</literal> -
	    一覧の中から、ユーザのシェルを入力してください。
	    シェルに関する詳細については <xref linkend="shells"/>
	    をご覧ください。</para>
	</listitem>

	<listitem>
	  <para><literal>Home directory</literal> -
	    ユーザのホームディレクトリ。
	    通常は、デフォルトの場所が適切です。</para>
	</listitem>

	<listitem>
	  <para><literal>Home directory permissions</literal> -
	    ユーザのホームディレクトリの権限。
	    通常は、デフォルトが適切です。</para>
	</listitem>

	<listitem>
	  <para><literal>Use password-based authentication?</literal> -
	    通常は、ユーザがログイン時にパスワードの入力が要求されるように
	    <literal>yes</literal> と入力してください。</para>
	</listitem>

	<listitem>
	  <para><literal>Use an empty password?</literal> -
	    通常は、パスワードがないと安全ではなくなるので、
	    <literal>no</literal> です。</para>
	</listitem>

	<listitem>
	  <para><literal>Use a random password?</literal> -
	    通常は、次のプロンプトでユーザ自身のパスワードを入力できるように、
	    <literal>no</literal> です。</para>
	</listitem>

	<listitem>
	  <para><literal>Enter password</literal> -
	    ユーザのパスワードです。
	    入力している文字は画面に表示されません。</para>
	</listitem>

	<listitem>
	  <para><literal>Enter password again</literal> -
	    確認のため、パスワードをもう一度入力します。</para>
	</listitem>

	<listitem>
	  <para><literal>Lock out the account after
	      creation?</literal>
	    - 通常は、ユーザがログインできるようにするため、
	    <literal>no</literal> です。</para>
	</listitem>
      </itemizedlist>

      <para>すべてを入力したら、サマリが表示され、
	正しいかどうかの確認を求められます。
	入力した情報に間違いがあれば、
	<literal>no</literal> を入力してもう一度作業を行なってください。
	すべてが正しく入力されていれば、
	<literal>yes</literal> を入力して、
	新しいユーザを作成してください。</para>

      <figure xml:id="bsdinstall-add-user3">
	<title>ユーザおよびグループの管理を終了する</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-adduser3"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>さらにユーザを追加するのであれば、
	<literal>Add another user?</literal> の質問に対し、
	<literal>yes</literal> を入力してください。
      	<literal>no</literal> を入力すると、ユーザの追加が終わり、次に進みます。</para>

      <para>ユーザの追加や、ユーザ管理の詳細については、
	<xref linkend="users-synopsis"/> を参照してください。</para>
    </sect2>

    <sect2 xml:id="bsdinstall-final-conf">
      <title>最後の設定</title>

      <para>すべてをインストールし、設定が終わった後に、
	最後に設定を修正する機会が与えられます。</para>

      <figure xml:id="bsdinstall-final-config">
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-finalconfiguration"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>インストールを完了する前に、
	このメニューを使って変更、または、追加の設定を行なってください。</para>

      <itemizedlist>
	<title>最終の設定オプション</title>

	<listitem>
	  <para><literal>Add User</literal> -
	    <xref linkend="bsdinstall-addusers"/> で説明しています。</para>
	</listitem>

	<listitem>
	  <para><literal>Root Password</literal> -
	    <xref linkend="bsdinstall-post-root"/> で説明しています。</para>
	</listitem>

	<listitem>
	  <para><literal>Hostname</literal> -
	    <xref linkend="bsdinstall-hostname"/> で説明しています。</para>
	</listitem>

	<listitem>
	  <para><literal>Network</literal> - <xref
	      linkend="bsdinstall-config-network-dev"/>
	    で説明しています。</para>
	</listitem>

	<listitem>
	  <para><literal>Services</literal> -
	    <xref linkend="bsdinstall-sysconf"/> で説明しています。</para>
	</listitem>

	<listitem>
	  <para><literal>System Hardening</literal> -
	    <xref linkend="bsdinstall-hardening"/> で説明しています。</para>
	</listitem>

	<listitem>
	  <para><literal>Time Zone</literal> -
	    <xref linkend="bsdinstall-timezone"/> で説明しています。</para>
	</listitem>

	<listitem>
	  <para><literal>Handbook</literal> -
	    &os; ハンドブックのダウンロードとインストール。</para>
	</listitem>
      </itemizedlist>

      <para>最後の設定が完了したら、<guibutton>Exit</guibutton>
	を選んでください。</para>

      <figure xml:id="bsdinstall-final-modification-shell">
	<title>Manual Configuration</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-final-modification-shell"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>新しいシステムを再起動する前に、
	<application>bsdinstall</application>
	は追加の設定が必要かどうかを尋ねてきます。
	<guibutton>[&nbsp;Yes&nbsp;]</guibutton>
	を選択して新しいシステムのシェルに入るか、または
	<guibutton>[&nbsp;No&nbsp;]</guibutton>
	を選択して、インストールの最後のステップに進んでください。</para>

      <figure xml:id="bsdinstall-final-main">
	<title>インストールの終了</title>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="bsdinstall/bsdinstall-mainexit"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>追加の設定や、特別なセットアップが必要であれば、
	<guibutton>[&nbsp;Live&nbsp;CD&nbsp;]</guibutton>
	を選んでインストールメディアを
	Live <acronym>CD</acronym> で起動してください。</para>

      <para>インストールが終わったら、
	<guibutton>[&nbsp;Reboot&nbsp;]</guibutton> を選んで、
	コンピュータを再起動し、新しい &os; システムで起動してください。
	再起動する前には、忘れずに &os; インストールメディアを外してください。
	さもないと、もう一度インストールメディアから起動してしまいます。</para>

      <para>&os; の起動時には、多くのメッセージが画面に表示されます。
	システムの起動後には、ログインプロンプトが表示されます。
	<prompt>login:</prompt> プロンプトで、
	インストール時に追加したユーザ名を入力してください。
	<systemitem class="username">root</systemitem>
	でのログインは避けてください。管理者の権限が必要となった時に、
	スーパユーザになる方法については、<xref linkend="users-superuser"/>
	を参照してください。</para>

      <para>起動時に表示されていたメッセージは、
	<keycap>Scroll-Lock</keycap> を押し、
	scroll-back buffer で見ることができます。
	<keycap>PgUp</keycap>, <keycap>PgDn</keycap>
	そして矢印キーでメッセージをスクロールバックできます。
	メッセージの確認が終わったら、<keycap>Scroll-Lock</keycap>
	をもう一度押すと、ディスプレイのロックを外し、
	コンソールに戻ることができます。
	何度かシステムを起動した後で、これらのメッセージを見るには、
	コマンドプロンプトから
	<command>less /var/run/dmesg.boot</command>
	と入力してください。
	確認後に <keycap>q</keycap> を押すと、
	コマンドラインに戻ります。</para>

      <para><xref
	  linkend="bsdinstall-config-serv"/> にて、
	<application>sshd</application> を有効に設定した場合には、
	最初の起動時にシステムが <acronym>RSA</acronym> および
	<acronym>DSA</acronym> キーを生成するため、
	少々時間がかかるかもしれません。
	その後の起動はより速くなるでしょう。
	鍵のフィンガープリントは、以下の例のように表示されます。</para>

      <screen>Generating public/private rsa1 key pair.
Your identification has been saved in /etc/ssh/ssh_host_key.
Your public key has been saved in /etc/ssh/ssh_host_key.pub.
The key fingerprint is:
10:a0:f5:af:93:ae:a3:1a:b2:bb:3c:35:d9:5a:b3:f3 root@machine3.example.com
The key's randomart image is:
+--[RSA1 1024]----+
|    o..          |
|   o . .         |
|  .   o          |
|       o         |
|    o   S        |
|   + + o         |
|o . + *          |
|o+ ..+ .         |
|==o..o+E         |
+-----------------+
Generating public/private dsa key pair.
Your identification has been saved in /etc/ssh/ssh_host_dsa_key.
Your public key has been saved in /etc/ssh/ssh_host_dsa_key.pub.
The key fingerprint is:
7e:1c:ce:dc:8a:3a:18:13:5b:34:b5:cf:d9:d1:47:b2 root@machine3.example.com
The key's randomart image is:
+--[ DSA 1024]----+
|       ..     . .|
|      o  .   . + |
|     . ..   . E .|
|    . .  o o . . |
|     +  S = .    |
|    +  . = o     |
|     +  . * .    |
|    . .  o .     |
|      .o. .      |
+-----------------+
Starting sshd.</screen>

      <para>フィンガープリントおよび <acronym>SSH</acronym>
	についての詳細については、<xref linkend="openssh"/>
	をご覧ください。</para>

      <para>&os; はデフォルトでは、グラフィカルな環境をインストールしません。
	グラフィカルなウィンドウマネージャのインストール、
	および設定に関するより多くの情報については、
	<xref linkend="x11"/> をご覧ください。</para>

      <para>適切に &os; をシャットダウンすることは、
	ハードウェアをダメージから守ったり、データの保護につながります。
	<emphasis>システムを適切にシャットダウンする前に、
	電源を落すということはしないでください!</emphasis>
	<systemitem class="groupname">wheel</systemitem>
	グループのメンバとなっているユーザは、
	コマンドラインから <command>su</command> と入力し、
	<systemitem class="username">root</systemitem>
	のパスワードを入力してスーパユーザとなってください。
	その後、<command>shutdown -p now</command>
	と入力すると、システムは正しくシャットダウンし、
	ハードウェアが対応していれば、電源が落ちます。</para>
    </sect2>
  </sect1>

  <sect1 xml:id="bsdinstall-network">
    <title>ネットワークインタフェース</title>

    <sect2 xml:id="bsdinstall-config-network-dev">
      <title>ネットワークインタフェースの設定</title>

      <para>次に、
	コンピュータが認識したすべてのネットワークインタフェースが表示されます。
	設定するネットワークインタフェースを選んでください。</para>

      <figure xml:id="bsdinstall-configure-net-interface">
	<title>イーサネットインタフェースの選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-interface"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>イーサネットインタフェースを選択したのであれば、<xref
	  linkend="bsdinstall-configure-net-ipv4"/>
	で表示されるメニューまで飛びます。
	ワイヤレスネットワークを選択したのであれば、
	システムはワイヤレスアクセスポイントをスキャンします。</para>

      <figure xml:id="bsdinstall-wireless-scan">
	<title>ワイヤレスアクセスポイントのスキャン</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-wireless-scan"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>ワイヤレスネットワークは Service Set Identifier
	(<acronym>SSID</acronym>) によって識別されます。
	<acronym>SSID</acronym> は、それぞれのネットワークに与えられる、
	短く、一意的な名前です。
	スキャンで見つかった <acronym>SSID</acronym> の一覧は、
	そのネットワークで利用できる暗号化のタイプの説明とともに表示されます。
	もし、期待した <acronym>SSID</acronym>
	が一覧に表示されていなければ、
	<guibutton>[&nbsp;Rescan&nbsp;]</guibutton>
	を選択してもう一度スキャンしてください。
	もし、期待したネットワークが表示されなければ、
	接続のためのアンテナを確認したり、
	コンピュータをアクセスポイントの近くに移動させてみてください。
	その後もう一度スキャンしてください。</para>

      <figure xml:id="bsdinstall-wireless-accesspoints">
	<title>ワイヤレスネットワークの選択</title>
	
	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-wireless-accesspoints"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>次に、
	ワイヤレスネットワークに接続するための暗号情報を入力してください。
	<acronym>WEP</acronym> のような古い暗号の安全性は低いので、
	<acronym>WPA2</acronym> 暗号が強く推奨されます。
	<acronym>WPA2</acronym> を使用してるネットワークでは、
	Pre-Shared Key (<acronym>PSK</acronym>)
	と呼ばれるパスワードを入力してください。
	セキュリティ上の観点から、
	入力ボックスに入力した文字はアスタリスクで表示されます。</para>

      <figure xml:id="bsdinstall-wireless-wpa2">
	<title>WPA2 のセットアップ</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-wireless-wpa2setup"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>次は、イーサネットもしくはワイヤレスインタフェースに対して、
        <acronym>IPv4</acronym> を設定するかどうかを選択します。</para>

      <figure xml:id="bsdinstall-configure-net-ipv4">
	<title><acronym>IPv4</acronym> ネットワークの選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-interface-ipv4"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><acronym>IPv4</acronym> の設定方法は 2 通りあります。
	<emphasis><acronym>DHCP</acronym></emphasis>
	はネットワークインタフェースを自動的に適切に設定する方法で、
	<acronym>DHCP</acronym> サーバのあるネットワークでは使用すべきです。
	もし、<acronym>DHCP</acronym> を利用できない環境では、
	静的な設定として、
	ネットワークのアドレス情報を手動で入力する必要があります。</para>

      <note>
	<para>適当なネットワーク情報を入力しても動かないので、
	  <acronym>DHCP</acronym> サーバが利用できなのであれば、
	  ネットワーク管理者またはサービスプロバイダから <xref
	    linkend="bsdinstall-collect-network-information"/>
	  に示されている情報を入手してください。</para>
      </note>

      <para><acronym>DHCP</acronym> サーバを利用できるのであれば、
	次のメニューで <guibutton>[&nbsp;Yes&nbsp;]</guibutton> を選択して、
	ネットワークインタフェースの設定を自動的に行ってください。
	インストーラは <acronym>DHCP</acronym> サーバを検索し、
	システムに対するアドレス情報を入手するために、
	少しの間停止しているように表示されます。</para>
	
      <figure xml:id="bsdinstall-net-ipv4-dhcp">
	<title><acronym>IPv4</acronym>
	  <acronym>DHCP</acronym> 設定の選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-interface-ipv4-dhcp"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><acronym>DHCP</acronym> サーバを利用できない環境では、
	<guibutton>[&nbsp;No&nbsp;]</guibutton> を選択し、
	このメニューにおいて以下のアドレス情報を入力してください。</para>

      <figure xml:id="bsdinstall-net-ipv4-static">
	<title><acronym>IPv4</acronym> の静的な設定</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-interface-ipv4-static"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <itemizedlist>
	<listitem>
	  <para><literal>IP Address</literal> -
	    コンピュータに手動で与える <acronym>IPv4</acronym> アドレスです。
	    このアドレスは一意的なものである必要があり、
	    すでにローカルネットワーク上の他のネットワーク機器で使われているものではいけません。</para>
	</listitem>

	<listitem>
	  <para><literal>Subnet Mask</literal> -
	    ネットワークのサブネットマスクです。</para>
	</listitem>

	<listitem>
	  <para><literal>Default Router</literal> -
	    このネットワークのデフォルトゲートウェイの <acronym>IP</acronym>
	    アドレスです。</para>
	</listitem>
      </itemizedlist>

      <para>次の画面では、インタフェースを <acronym>IPv6</acronym>
	で設定すべきかを選択します。
	<acronym>IPv6</acronym> が利用でき、希望するのであれば、
	<guibutton>[&nbsp;Yes&nbsp;]</guibutton> を選択してください。</para>

      <figure xml:id="bsdinstall-net-ipv6">
	<title>IPv6 ネットワークの選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-interface-ipv6"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><acronym>IPv6</acronym> の設定に関しても 2 つの方法があります。
	StateLess Address AutoConfiguration
	(<emphasis><acronym>SLAAC</acronym></emphasis>)
	は、ローカルルータから適切なネットワーク設定情報を入手するように、
	自動的にリクエストします。
	詳細については <link
	  xlink:href="http://tools.ietf.org/html/rfc4862">http://tools.ietf.org/html/rfc4862</link>
	を参照してください。静的な設定では、
	ネットワーク情報を手動で入力する必要があります。</para>

      <para><acronym>IPv6</acronym> ルータを利用できるのであれば、
	次のメニューで <guibutton>[&nbsp;Yes&nbsp;]</guibutton> を選択し、
	ネットワークインタフェースの設定を自動的に行ってください。
	インストーラはルータを見つけ出し、
	システムに対するアドレス情報を入手するために、
	少しの間停止しているように表示されます。</para>

      <figure xml:id="bsdinstall-net-ipv6-slaac">
	<title><acronym>IPv6</acronym> SLAAC 設定の選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-interface-slaac"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para><acronym>IPv6</acronym> ルータが利用できない環境では、
	<guibutton>[&nbsp;No&nbsp;]</guibutton> を選択して、
	表示されるメニューで以下のアドレス情報を入力する必要があります。</para>

      <figure xml:id="bsdinstall-net-ipv6-static">
	<title>IPv6 の静的な設定</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-interface-ipv6-static"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <itemizedlist>
	<listitem>
	  <para><literal>IPv6 Address</literal> -
	    このコンピュータに割り当てられた
	    <acronym>IPv6</acronym> アドレスです。
	    このアドレスは一意的なものである必要があり、
	    すでにローカルネットワーク上の他のネットワーク機器で使われているものではいけません。</para>
	</listitem>

	<listitem>
	  <para><literal>Default Router</literal> -
	    このネットワークのデフォルトゲートウェイの <acronym>IPv6</acronym>
	    アドレスです。</para>
	</listitem>
      </itemizedlist>

      <para>最後のネットワークメニューでは、
	Domain Name System (<acronym>DNS</acronym>)
	リゾルバを設定します。
	これは、ホスト名とネットワークアドレスを変換します。
	すでに <acronym>DHCP</acronym> または <acronym>SLAAC</acronym>
	を使って自動的にネットワークインタフェースを設定したのであれば、
	<literal>Resolver Configuration</literal>
	には値がすでに入っているでしょう。
	そうでなければ、<literal>Search</literal>
	フィールドにローカルネットワークのドメイン名を入力してください。
	<literal>DNS</literal> #1 および <literal>DNS</literal> #2 は、
	ローカル <acronym>DNS</acronym> サーバの
	<acronym>IPv4</acronym> または <acronym>IPv6</acronym> アドレスです。
	少なくとも、1 つの <acronym>DNS</acronym> サーバは必要です。</para>

      <figure xml:id="bsdinstall-net-dns-config">
	<title>DNS の設定</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-configure-network-ipv4-dns"/>
	  </imageobject>
	</mediaobject>
      </figure>

      <para>ネットワーク接続の設定が終わったら、&os;
	をインストールするコンピュータと同じ地域のミラーサイトを選んでください。
	ターゲットコンピュータの近くにミラーサイトがあると、
	ファイルのダウンロードは早く終わるので、
	インストールの時間は短くなります。</para>

      <figure xml:id="bsdinstall-netinstall-mirror">
	<title>ミラーサイトの選択</title>

	<mediaobject>
	  <imageobject>
	    <imagedata
	      fileref="bsdinstall/bsdinstall-netinstall-mirrorselect"/>
	  </imageobject>
	</mediaobject>
      </figure>
    </sect2>
  </sect1>

  <sect1 xml:id="bsdinstall-install-trouble">
    <title>トラブルシューティング</title>

    <indexterm>
      <primary>インストール</primary>
      <secondary>トラブルシューティング</secondary>
    </indexterm>
    <para>この章では、インストールの際の、
      これまで報告された共通の問題に対する解決のための情報が書いてあります。</para>

    <para>インストールする &os; のバージョンのハードウェアノート (<link
	xlink:href="&url.base;/ja/releases/index.html">https://www.freebsd.org/ja/releases/index.html</link>)
      を調べて、
      使用しているハードウェアに対応しているかどうかを確認してください。
      もしハードウェアがサポートされているにもかかわらず、
      動作しなかったり他の問題点がある時は、
      <xref linkend="kernelconfig"/> で説明されている方法で
      カスタムカーネルを構築して、<filename>GENERIC</filename>
      カーネルに含まれていないデバイスへのサポートを追加してください。
      起動ディスクのカーネルでは、ほとんどのハードウェアデバイスの
      <acronym>IRQ</acronym>, <acronym>I/O</acronym> アドレス、
      <acronym>DMA</acronym>
      チャネルが工場出荷時の状態であると設定されています。
      もしハードウェアの設定が変更されている場合には、
      カーネルコンフィグレーションファイルを編集することにより、
      &os; に設定することが可能です。</para>

    <note>
      <para>いくつかのインストール上の問題は、さまざまなハードウェア装置、
	特にマザーボードのファームウェアのアップデートで回避または緩和することができます。
	マザーボードのファームウェアは、通常 <acronym>BIOS</acronym>
	と呼ばれます。
	多くのマザーボードまたはコンピュータ製造メーカーは、
	アップデートやアップグレード情報を載せているウェブサイトを用意しています。</para>

      <para>通常、製造メーカーは、
	重要な更新のようなそれなりの理由がない限り、マザーボードの
	<acronym>BIOS</acronym> のアップグレードは行わないよう推奨しています。
	アップデートの過程で失敗する<emphasis>可能性があり</emphasis>、
	その場合 <acronym>BIOS</acronym> が不完全な状態になり、
	コンピュータが動作しない原因となり得るからです。</para>
    </note>

    <para>システムの起動時に、ハードウェアの検出中にシステムが固まったり、
      インストール中におかしな振る舞いをする場合には、
      <acronym>ACPI</acronym> が原因の可能性があります。
      &arch.i386; および &arch.amd64; プラットフォームにおいて、
      &os; はシステムの設定を手助けするシステム
      <acronym>ACPI</acronym> サービスを、
      起動時に検出された場合に広く使います。
      残念ながら、まだいくつかの不具合が、
      <acronym>ACPI</acronym> ドライバとシステムのマザーボードおよび
      <acronym>BIOS</acronym> ファームウェア両方に存在しています。
      起動ステージ 3 において、ヒント情報
      <literal>hint.acpi.0.disabled</literal>
      を以下のように設定すると <acronym>ACPI</acronym>
      を無効にできます。</para>

    <screen><userinput>set hint.acpi.0.disabled="1"</userinput></screen>

    <para>この設定はシステムが起動するたびにリセットされるので、
      <filename>/boot/loader.conf</filename> ファイルに
      <literal>hint.acpi.0.disabled="1"</literal> を追加する必要があります。
      ブートローダのより詳しい情報については
      <xref linkend="boot-synopsis"/> で説明します。</para>
  </sect1>

  <sect1 xml:id="using-live-cd">
    <title>Live <acronym>CD</acronym> を使う</title>

    <para><xref linkend="bsdinstall-choose-mode"/> で示されている
      <application>bsdinstall</application> のウェルカムメニューは、
      <guibutton>[&nbsp;Live&nbsp;CD&nbsp;]</guibutton>
      オプションを提供します。
      これは、
      オペレーティングシステムに &os; を使うべきかどうか迷っていて、
      インストール前に機能を試して見たいと思っている方に有用です。</para>

    <para><guibutton>[&nbsp;Live&nbsp;CD&nbsp;]</guibutton>
      を使う際は、以下のことに気をつけてください。</para>

    <itemizedlist>
      <listitem>
	<para>システムにアクセスする際には、認証を求められます。
	  ユーザ名は <systemitem class="username">root</systemitem>、
	  パスワードは空欄としてください。</para>
      </listitem>

      <listitem>
	<para>システムはインストールメディアから直接起動するので、
	  ハードディスクにインストールされたシステムに比べ、
	  パフォーマンスはかなり遅い可能性があります。</para>
      </listitem>

      <listitem>
	<para>このオプションのユーザインタフェースは、
	  コマンドプロンプトのみです。
	  グラフィカルなユーザインタフェースではありません。</para>
      </listitem>
    </itemizedlist>
  </sect1>
</chapter>

<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE article PUBLIC "-//FreeBSD//DTD DocBook XML V5.0-Based Extension//EN"
"../../../../../share/xml/freebsd50.dtd" [
<!ENTITY % release PUBLIC "-//FreeBSD//ENTITIES Release Specification//EN" "../share/xml/release.ent">
 %release;
<!ENTITY % sponsor PUBLIC "-//FreeBSD//ENTITIES Sponsor Specification//EN" "../share/xml/sponsor.ent">
 %sponsor;
<!ENTITY % vendor PUBLIC "-//FreeBSD//ENTITIES Vendor Specification//EN" "../share/xml/vendor.ent">
 %vendor;
<!ENTITY security SYSTEM "../share/xml/security.xml">
<!ENTITY errata SYSTEM "../share/xml/errata.xml">
]>
<article xmlns="http://docbook.org/ns/docbook"
  xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">

  <info>
    <title>&os; &release.current; Release Notes</title>

    <author>
      <orgname>The &os; Project</orgname>
    </author>

    <pubdate>$FreeBSD$</pubdate>

    <!-- First rev: 339953 -->
    <!-- Last rev: 335799 -->

    <copyright>
      <year>2018</year>
      <holder role="mailto:doc@FreeBSD.org">The &os; Documentation
	Project</holder>
    </copyright>

    <legalnotice xml:id="trademarks" role="trademarks">
      &tm-attrib.freebsd;
      &tm-attrib.ibm;
      &tm-attrib.ieee;
      &tm-attrib.intel;
      &tm-attrib.sparc;
      &tm-attrib.general;
    </legalnotice>

    <abstract>
      <para>The release notes for &os; &release.current; contain
	a summary of the changes made to the &os; base system on the
	&release.branch; development line.  This document lists
	applicable security advisories that were issued since the last
	release, as well as significant changes to the &os; kernel and
	userland.  Some brief remarks on upgrading are also
	presented.</para>
    </abstract>
  </info>

  <sect1 xml:id="intro">
    <title>Introduction</title>

    <para>This document contains the release notes for &os;
      &release.current;.  It describes recently added, changed, or
      deleted features of &os;.  It also provides some notes on
      upgrading from previous versions of &os;.</para>

    <para releasetype="current">The &release.type; distribution to
      which these release notes apply represents the latest point
      along the &release.branch; development branch since
      &release.branch; was created.  Information regarding pre-built,
      binary &release.type; distributions along this branch can be
      found at <uri
	xlink:href="&release.url;">&release.url;</uri>.</para>

    <para releasetype="snapshot">The &release.type; distribution to
      which these release notes apply represents a point along the
      &release.branch; development branch between &release.prev; and
      the future &release.next;.  Information regarding pre-built,
      binary &release.type; distributions along this branch can be
      found at <uri
	xlink:href="&release.url;">&release.url;</uri>.</para>

    <para releasetype="release">This distribution of &os;
      &release.current; is a &release.type; distribution.  It can be
      found at <uri xlink:href="&release.url;">&release.url;</uri> or
      any of its mirrors.  More information on obtaining this (or
      other) &release.type; distributions of &os; can be found in the
      <link
	xlink:href="&url.books.handbook;/mirrors.html"><quote>Obtaining
	  &os;</quote> appendix</link> to the <link
	xlink:href="&url.books.handbook;/">&os;
	Handbook</link>.</para>

    <para>All users are encouraged to consult the release errata
      before installing &os;.  The errata document is updated with
      <quote>late-breaking</quote> information discovered late in the
      release cycle or after the release.  Typically, it contains
      information on known bugs, security advisories, and corrections
      to documentation.  An up-to-date copy of the errata for &os;
      &release.current; can be found on the &os; Web site.</para>

    <para>This document describes the most user-visible new or changed
      features in &os; since &release.prev;.  In general, changes
      described here are unique to the &release.branch; branch unless
      specifically marked as &merged; features.</para>

    <para>Typical release note items document recent security
      advisories issued after &release.prev;, new drivers or hardware
      support, new commands or options, major bug fixes, or
      contributed software upgrades.  They may also list changes to
      major ports/packages or release engineering practices.  Clearly
      the release notes cannot list every single change made to &os;
      between releases; this document focuses primarily on security
      advisories, user-visible changes, and major architectural
      improvements.</para>
  </sect1>

  <sect1 xml:id="upgrade">
    <title>Upgrading from Previous Releases of &os;</title>

    <para arch="amd64,i386">Binary upgrades between RELEASE versions
      (and snapshots of the various security branches) are supported
      using the &man.freebsd-update.8; utility.  The binary upgrade
      procedure will update unmodified userland utilities, as well as
      unmodified GENERIC kernels distributed as a part of an official
      &os; release.  The &man.freebsd-update.8; utility requires that
      the host being upgraded have Internet connectivity.</para>

    <para>Source-based upgrades (those based on recompiling the &os;
      base system from source code) from previous versions are
      supported, according to the instructions in
      <filename>/usr/src/UPDATING</filename>.</para>

    <important>
      <para>Upgrading &os; should only be attempted after backing up
	<emphasis>all</emphasis> data and configuration files.</para>
    </important>
  </sect1>

  <sect1 xml:id="security-errata">
    <title>Security and Errata</title>

    <para>This section lists the various Security Advisories and
      Errata Notices since &release.prev;.</para>

    <sect2 xml:id="security">
      <title>Security Advisories</title>

      <informaltable frame="none" pgwide="1">
	<tgroup cols="3">
	  <colspec colwidth="40%"/>
	  <colspec colwidth="30%"/>
	  <colspec colwidth="30%"/>
	  <thead>
	    <row>
	      <entry>Advisory</entry>
	      <entry>Date</entry>
	      <entry>Topic</entry>
	    </row>
	  </thead>

	  <tbody>
	    <row>
	      <entry><para>No advisories.</para></entry>
	      <entry><para>&nbsp;</para></entry>
	      <entry><para>&nbsp;</para></entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>
    </sect2>

    <sect2 xml:id="errata">
      <title>Errata Notices</title>

      <informaltable frame="none" pgwide="1">
	<tgroup cols="3">
	  <colspec colwidth="40%"/>
	  <colspec colwidth="30%"/>
	  <colspec colwidth="30%"/>
	  <thead>
	    <row>
	      <entry>Errata</entry>
	      <entry>Date</entry>
	      <entry>Topic</entry>
	    </row>
	  </thead>

	  <tbody>
	    <row>
	      <entry><para>No errata notices.</para></entry>
	      <entry><para>&nbsp;</para></entry>
	      <entry><para>&nbsp;</para></entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>
    </sect2>
  </sect1>

  <sect1 xml:id="userland">
    <title>Userland</title>

    <para>This section covers changes and additions to userland
      applications, contributed software, and system utilities.</para>

    <sect2 xml:id="userland-config">
      <title>Userland Configuration Changes</title>

      <para revision="335864" contrib="sponsor"
	sponsor="&darpa_afrl;">Group permissions on
	<filename>/dev/acpi</filename> have been changed to allow
	users in the <literal>operator</literal>
	<acronym>GID</acronym> to invoke &man.acpiconf.8; to suspend
	the system.</para>

      <para revision="336565">The default &man.devfs.rules.5;
	configuration has been updated to allow &man.mount.fusefs.8;
	with &man.jail.8;.</para>

      <para revision="337497">The default <literal>PAGER</literal> now
	defaults to &man.less.1; for most commands.</para>

      <para revision="338165" contrib="sponsor"
	sponsor="&dellemc;">The &man.newsyslog.8; utility has been
	updated to reject configuration entries that specify
	&man.setuid.2; or executable log files.</para>

      <para revision="338642" contrib="sponsor" sponsor="&ff;">The
	<literal>WITH_REPRODUCIBLE_BUILD</literal> &man.src.conf.5;
	knob has been enabled by default.</para>

      <para revision="339303"><application>LDNS</application> now
	enables <literal>DANE-TA</literal>, and
	<literal>GOST</literal> has been removed.</para>

      <para revision="340773" contrib="sponsor" sponsor="&ff;">A new
	&man.src.conf.5; knob, <literal>WITH_RETPOLINE</literal>, has
	been added to enable the retpoline mitigation for userland
	builds.</para>
    </sect2>

    <sect2 xml:id="userland-programs">
      <title>Userland Application Changes</title>

      <para>xlint and the ability to build lint libraries or lint
	source code has been removed.</para>

      <para revision="304200">The &man.dtrace.1; utility has been
	updated to support <literal>if</literal> and
	<literal>else</literal> statements.</para>

      <para revision="317416">The legacy &man.gdb.1; utility included
	in the base system is now installed to <filename
	  class="directory">/usr/libexec</filename> for use with
	&man.crashinfo.8;.  The <application>gdbserver</application>
	and <application>gdbtui</application> utilities are no longer
	installed.  For interactive debugging, &man.lldb.1; or
	a modern version of &man.gdb.1; from <filename
	  role="package">devel/gdb</filename> should be used.  A new
	&man.src.conf.5; knob, <literal>WITHOUT_GDB_LIBEXEC</literal>
	has been added to disable building &man.gdb.1;.  The
	&man.gdb.1; utility is still installed in <filename
	  class="directory">/usr/bin</filename> on
	&arch.sparc64;.</para>

      <para revision="332396" contrib="sponsor" sponsor="&ff;">The
	&man.setfacl.1; utility has been updated to include a new
	flag, <literal>-R</literal>, used to operate recursively on
	directories.</para>

      <para revision="323865">The &man.cat.1; utility has been updated
	to print output aligned the same regardless of if invoked with
	<literal>-ne</literal> or <literal>-be</literal>.</para>

      <para revision="334391" contrib="sponsor" sponsor="&ff;">The
	default bootstrap linker has been changed to &man.ld.lld.1;
	for &arch.amd64;.</para>

      <para revision="334443">The &man.dhclient.8; utility has been
	updated to add a configuration knob to allow superseding the
	<literal>interface-mtu</literal> option provided by an
	incorrectly-configured <acronym>DHCP</acronym> server.</para>

      <para revision="335222" contrib="sponsor" sponsor="&ff;">The
	&man.asf.8; utility has been removed, as &man.kgdb.1; now
	handles kernel module state internally.</para>

      <para revision="336126">The <literal>sha224(1)</literal> utility
	has been added.</para>

      <para revision="336659">The &man.geli.8; utility has been
	updated to provide support for initializing multiple providers
	at once when they use the same passphrase and/or key.</para>

      <para revision="336901" contrib="sponsor" sponsor="&ff;">The
	default bootstrap linker has been changed to &man.ld.lld.1;
	for &arch.i386;.</para>

      <para revision="337057" contrib="sponsor" sponsor="&ff;">The
	default bootstrap linker has been changed to &man.ld.lld.1;
	for &arch.armv7;.</para>

      <para revision="337505">The &man.dd.1; utility has been updated
	to add the <literal>status=progress</literal> option, which
	prints the status of its operation on a single line once per
	second, similar to <acronym>GNU</acronym> &man.dd.1;.</para>

      <para revision="337332">The &man.date.1; utility has been
	updated to include a new flag, <literal>-I</literal>, which
	prints its output in <acronym>ISO</acronym> 8601
	formatting.</para>

      <para revision="337663">The &man.bectl.8; utility has been
	added, providing an administrative interface for managing
	<acronym>ZFS</acronym> boot environments, similar to
	<filename role="package">sysutils/beadm</filename>.</para>

      <para revision="337956">The &man.ls.1; utility has been updated
	to include a new
	<literal>--color=<replaceable>when</replaceable></literal>
	flag, where <replaceable>when</replaceable> can be one of
	<literal>always</literal>, <literal>auto</literal> (default),
	or <literal>never</literal>.</para>

      <para revision="338210" contrib="sponsor" sponsor="&ix;">The
	&man.bhyve.8; utility has been updated to add a new subcommand
	to the <literal>-l</literal> and <literal>-s</literal> flags,
	<literal>help</literal>, which when used, prints a list of
	supported <acronym>LPC</acronym> and <acronym>PCI</acronym>
	devices, respectively.</para>

      <para revision="338258">The &man.tftp.1; utility has been
	updated to change the default transfer mode from
	<acronym>ASCII</acronym> to binary.</para>

      <para revision="338352">The &man.last.1; utility has been
	updated to include &man.libxo.3; support.</para>

      <para revision="338353">The &man.lastlogin.8; utility has been
	updated to include &man.libxo.3; support.</para>

      <para revision="338950" contrib="sponsor"
	sponsor="&dellemc;">The &man.chown.8; utility has been updated
	to prevent overflow of <acronym>UID</acronym> or
	<acronym>GID</acronym> arguments where the argument exceeded
	<literal>UID_MAX</literal> or <literal>GID_MAX</literal>,
	respectively.</para>

      <para revision="340444">The &man.ctm.1; and related utilities
	have been marked as deprecated for removal in
	&os;&nbsp;13.0.</para>
    </sect2>

    <sect2 xml:id="userland-contrib">
      <title>Contributed Software</title>

      <para revision="333063" contrib="sponsor" sponsor="&ff;">The
	<application>ELF Tool Chain</application> has been updated
	to version r3614.</para>

      <para revision="331602" contrib="sponsor"
	sponsor="&dellemc;">The &man.zstd.1; utility has been updated
	to version 1.3.4.</para>

      <para revision="332452" contrib="sponsor" sponsor="&ff;">The
	&man.vt.4; Terminus BSD Console font has been updated to
	version 4.46.</para>

      <para revision="333783">The &man.xz.1; utility has been updated
	to version 5.2.4.</para>

      <para revision="335799">The <application>clang</application>,
	<application>llvm</application>,
	<application>lld</application>,
	<application>lldb</application>,
	<application>compiler-rt</application> utilities and
	<application>libc++</application> have been updated to version
	6.0.1.</para>

      <para revision="335885">The <application>bsnmp</application>
	utility has been updated to version 1.13.</para>

      <para revision="336203">The <acronym>WPA</acronym> utilities
	have been updated to version 2.6.</para>

      <para revision="336525">The &man.ntpd.8; utility has been
	updated to allow being run as a non-root user.</para>

      <note>
	<para>Source-based upgrades from &os;&nbsp;11.x and earlier
	  require the <literal>ntpd</literal> <acronym>UID</acronym>
	  (123) and <acronym>GID</acronym> (123) to exist before the
	  <literal>installworld</literal> target is run.  See the
	  &quot;rebuild everything and install&quot; section of
	  <filename>UPDATING</filename> for the documented procedure
	  for source-based upgrades for more details.</para>
      </note>

      <para revision="337018">Support for <acronym>UDP</acronym>-lite
	has been added to &man.dtrace.udplite.4;.</para>

      <para revision="337442">The &man.file.1; utility has been
	updated to version 5.34.</para>

      <para revision="337810">The <application>lua</application>
	utility has been updated to version 5.3.5.</para>

      <para revision="338213">Support for send, receive, and
	state-change providers have been added to
	&man.dtrace.sctp.4;.</para>

      <para revision="338126">The &man.ntpd.8; utility has been
	updated to version 4.2.8p12.</para>

      <para revision="338561"><application>OpenSSH</application> has
	been updated to version 7.8p1.</para>

      <para revision="338826">The &man.mandoc.1; utility has been
	updated to version 1.14.4.</para>

      <para revision="339216">Additional &man.capsicum.4; support has
	been added to &man.sshd.8;.</para>

      <para revision="339256"><application>Serf</application> has been
	updated to version 1.3.9.</para>

      <para revision="339262"><application>ACPICA</application> has
	been updated to version 20181003.</para>

      <para revision="339278"><application>Unbound</application> has
	been updated to version 1.8.1.</para>

      <para revision="339937">The timezone database files have been
	updated to version 2018g.</para>

      <para revision="340711"><application>OpenSSL</application> has
	been updated to version 1.1.1a.</para>
    </sect2>

    <sect2 xml:id="userland-installer">
      <title>Installation and Configuration Tools</title>

      <para revision="338282" contrib="sponsor" sponsor="&klara;">The
	&man.bsdinstall.8; installer and &man.zfsboot.8; boot code
	have been updated to allow an
	<acronym>UEFI</acronym>+<acronym>GELI</acronym> installation
	option.</para>
    </sect2>

    <sect2 xml:id="userland-rc">
      <title><filename class="directory">/etc/rc.d</filename>
	Scripts</title>

      <para revision="332857" contrib="sponsor" sponsor="&ff;">A new
	&man.rc.8; has been added to create &man.cfumass.4;
	<acronym>LUN</acronym>s.</para>

      <para revision="335673">The &man.geli.8; &man.rc.8; script has
	been updated to include support for a new variable,
	<literal>geli_groups</literal>, which provides support to
	attach multiple providers when set in &man.rc.conf.5;.</para>

      <para revision="340348" contrib="sponsor" sponsor="&smule;">The
	&man.rc.8; subsystem has been updated to support new keywords
	in &man.rc.conf.5;, <literal>enable</literal>,
	<literal>disable</literal>, and
	<literal>delete</literal> with &man.rc.d.8; scripts and the
	&man.service.8; utility.  See &man.rc.conf.5; for usage
	information.</para>
    </sect2>

    <sect2 xml:id="userland-libraries">
      <title>Runtime Libraries and API</title>

      <para revision="331279">The &man.getrandom.2; system call and
	&man.getentropy.3; library have been added, compatible with
	&linux; and OpenBSD implementations.</para>

      <para revision="338059">The &man.arc4random.3; library has been
	updated to match the OpenBSD version 1.35.</para>

      <para revision="338600">The &man.libarchive.3; library has been
	updated to version 3.3.3.</para>
    </sect2>

    <sect2 xml:id="userland-abi">
      <title>ABI Compatibility</title>

      <para revision="331936"><function>get_s(3)</function> has been
	added.</para>

      <para revision="337992">The &man.pthread.3; library has been
	updated to incorporate
	<acronym>POSIX</acronym>/<acronym>SUSv4</acronym>-2018
	compliance improvements.</para>

      <para revision="338331">The &man.arc4random.3; library has been
	updated to remove <function>arc4random_stir()</function> and
	<function>arc4random_addrandom()</function>.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="kernel">
    <title>Kernel</title>

    <para>This section covers changes to kernel configurations, system
      tuning, and system control parameters that are not otherwise
      categorized.</para>

    <sect2 xml:id="kernel-bugfix">
      <title>Kernel Bug Fixes</title>

      <para revision="326956" contrib="sponsor"
	sponsor="&dellemc;">The <acronym>ACPI</acronym> subsystem has
	been updated to implement <literal>Device</literal> object
	types for <acronym>ACPI</acronym> 6.0 support, required for
	some &dell; Poweredge&trade; &amd; Epyc&trade; systems.</para>

      <para revision="334625" contrib="sponsor"
	sponsor="&dellemc;">An issue with <acronym>IPv6-AH</acronym>
	<acronym>IPSEC</acronym> padding has been fixed to match
	<acronym>RFC</acronym>4302.</para>

      <para revision="340446">The &man.amdsmn.4; and &man.amdtemp.4;
	drivers have been updated to attach to
	&amd;&nbsp;Ryzen&nbsp;2&trade; host bridges.</para>

      <para revision="340447">The &man.amdtemp.4; driver has been
	updated to fix temperature reporting for &amd;&nbsp;2990WX
	<acronym>CPU</acronym>s.</para>
    </sect2>

    <sect2 xml:id="kernel-config">
      <title>Kernel Configuration</title>

      <para revision="324810">The <literal>VIMAGE</literal> kernel
	configuration option has been enabled by default.</para>

      <para revision="324965" contrib="sponsor"
	sponsor="&dellemc;">The &man.dumpon.8; utility has been
	updated to add support for compressed kernel crash dumps when
	the kernel configuration file includes the
	<literal>GZIO</literal> option.  See &man.rc.conf.5; and
	&man.dumpon.8; for additional information.</para>

      <para revision="327584">The &man.ext2fs.5; filesystem has been
	updated to support full read/write support for ext4.</para>

      <para revision="327774">The <literal>pmtimer</literal> device
	has been removed from the &arch.i386;
	<filename>GENERIC</filename> kernel configuration.  Its
	functionality is now part of &man.apm.4;.</para>

      <para revision="329240" contrib="sponsor"
	sponsor="&dellemc;">The &man.dumpon.8; utility has been
	updated to add support for &man.zstd.1;-compressed kernel
	crash dumps when the kernel configuration file includes the
	<literal>ZSTDIO</literal> option.  See &man.rc.conf.5; and
	&man.dumpon.8; for additional information.</para>

      <para revision="330110" contrib="sponsor" sponsor="&ff;">A new
	&man.src.conf.5; knob,
	<literal>WITH_KERNEL_RETPOLINE</literal>, has been added to
	enable the retpoline mitigation for kernel builds.</para>

      <para revision="333890">The <literal>EKCD</literal>,
	<literal>GZIO</literal>, <literal>ZSTDIO</literal>, and
	<literal>NETDUMP</literal> kernel configuration options have
	been enabled by default for &arch.amd64;, &arch.i386;,
	&arch.arm64;, &arch.powerpc;, &arch.powerpc64;, and
	&arch.sparc64; architectures.</para>

      <para revision="338214" contrib="sponsor"
	sponsor="&dellemc;">A new kernel configuration option,
	<literal>KASSERT_PANIC_OPTIONAL</literal>, has been added
	that allows runtime &man.KASSERT.9; behavior changes without
	necessarily invoking &man.panic.9;.  The option is disabled
	by default.</para>

      <para revision="338602" contrib="sponsor"
	sponsor="&dellemc;, &netflix;">The <literal>NUMA</literal>
	option has been enabled by default in the &arch.amd64;
	<filename>GENERIC</filename> and <filename>MINIMAL</filename>
	kernel configurations.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="drivers">
    <title>Devices and Drivers</title>

    <para>This section covers changes and additions to devices and
      device drivers since &release.prev;.</para>

    <sect2 xml:id="drivers-device">
      <title>Device Drivers</title>

      <para revision="331070" contrib="sponsor"
	sponsor="&dellemc;">The &man.random.4; device has been updated
	to allow terminating large reads with
	<literal>^C</literal>.</para>

      <para revision="333713" contrib="sponsor" sponsor="&ff;">Support
	for the Microchip&reg; LAN78xx&trade; USB3-GigE controller has
	been added.</para>

      <para revision="333760" contrib="sponsor" sponsor="&ff;">A new
	<literal>multifunction</literal> device has been added to
	&man.usb.template.4;, providing mass storage,
	<acronym>CDC</acronym> <acronym>ACM</acronym> (serial), and
	<acronym>CDC</acronym> <acronym>ECM</acronym> (ethernet)
	simultaneously.</para>

      <para revision="338324">The &man.random.4; driver has been
	updated to remove the Yarrow algorithm.  The Fortuna algorithm
	remains the default, and now only, available algorithm.</para>

      <para revision="333283" contrib="sponsor"
	sponsor="&dellemc;">The &man.netdump.4; driver has been added,
	providing a facility through which kernel crash dumps can be
	transmitted to a remote host after a system panic.  See
	&man.netdump.4; and &man.dumpon.8; for more information and
	configuration details.</para>

      <para revision="338292">The &man.random.4; driver has been
	updated to fix excessive activity during pseudo-random number
	generation.</para>

      <para revision="338316">The &man.vt.4; driver has been updated
	with performance improvements, drawing text at rates ranging
	from 2- to 6-times faster.</para>

      <para revision="340190" contrib="sponsor"
	sponsor="&panzura;">The &man.ichwd.4; driver has been updated
	to add <acronym>TCO</acronym> watchdog timer support for
	&intel; Lewisburg <acronym>PCH</acronym> (C620)
	chipsets.</para>
    </sect2>

    <sect2 xml:id="drivers-network">
      <title>Network Drivers</title>

      <para revision="333149" contrib="sponsor"
	sponsor="&intelcorp;">The &man.ixl.4; driver has been updated
	to version 1.9.9-k.</para>

      <para revision="334143" contrib="sponsor"
	sponsor="&chelsio;">The &man.cxgbe.4; driver has been updated
	to provide hardware support for the
	<literal>SO_MAX_PACING_RATE</literal> &man.setsockopt.2;
	option when the kernel configuration contains the
	<literal>RATELIMIT</literal> option.</para>

      <para revision="339338" contrib="sponsor"
	sponsor="&intelcorp;">The &man.ixlv.4; driver has been renamed
	to &man.iavf.4; and updated to use &man.iflib.9;.  The
	&man.ixlv.4; kernel module is now a hard link to &man.iavf.4;
	for backwards compatibility for upgrading from earlier &os;
	releases.</para>
    </sect2>

    <sect2 xml:id="drivers-deprecated">
      <title>Deprecated Drivers</title>

      <para revision="333144" contrib="sponsor" sponsor="&ff;">The
	&man.lmc.4; driver has been removed.</para>

      <para revision="333173" contrib="sponsor"
	sponsor="&limelight;">The &man.ixgb.4; driver has been
	removed.</para>

      <para revision="333322" contrib="sponsor"
	sponsor="&limelight;">The &man.nxge.4; driver has been
	removed.</para>

      <para revision="333717" contrib="sponsor"
	sponsor="&limelight;">The &man.vxge.4; driver has been
	removed.</para>

      <para revision="337033">The &man.jedec.ts.4; driver has been
	removed in &release.current;, and its functionality replaced
	by &man.jedec.dimm.4;.</para>

      <para revision="339218">The <acronym>DRM</acronym> driver for
	modern graphics chipsets has been marked deprecated and marked
	for removal in &os;&nbsp;13.  The <acronym>DRM</acronym>
	kernel modules are available from <filename
	  role="package">graphics/drm-stable-kmod</filename> or
	<filename role="package">graphics/drm-legacy-kmod</filename>
	in the Ports Collection as well as via &man.pkg.8;.
	Additionally, the kernel modules have been added to the lua
	&man.loader.conf.5; <literal>module_blacklist</literal>, as
	installation from the Ports Collection or &man.pkg.8; is
	strongly recommended.</para>

      <para revision="339735">The following drivers have been
	deprecated in &os;&nbsp;12.0, and not present in
	&os;&nbsp;13.0: &man.ae.4;, &man.de.4;, &man.ed.4;,
	&man.ep.4;, &man.ex.4;, &man.fe.4;, &man.pcn.4;, &man.sf.4;,
	&man.sn.4;, &man.tl.4;, &man.tx.4;, &man.txp.4;, &man.vx.4;,
	&man.wb.4;, &man.xe.4;</para>
    </sect2>
  </sect1>

  <sect1 xml:id="hardware">
    <title>Hardware Support</title>

    <para>This section covers general hardware support for physical
      machines, hypervisors, and virtualization environments, as well
      as hardware changes and updates that do not otherwise fit in
      other sections of this document.</para>

    <sect2 xml:id="hardware-support">
      <title>Hardware Support</title>

      <para revision="333273">Support for powernv POWER9
	<acronym>MMU</acronym> initialization has been added.</para>
    </sect2>

    <sect2 xml:id="hardware-graphics">
      <title>Graphics Support</title>

      <para>&os; has changed the way graphics drivers are handled on
	&arch.amd64; and &arch.i386;.  Graphics drivers for modern
	ATI/&amd; and &intel; graphics cards are now available in the
	Ports Collection.  The base drivers are still available and
	will be installed by default, but they lack support for
	current generation laptop and desktop systems.</para>

      <para>In most cases it is enough to install <filename
	  role="package">graphics/drm-kmod</filename>
	from ports or packages to install a driver appropriate for the
	system, then adding the appropriate driver to
	<varname>kld_list</varname> in &man.rc.conf.5;.</para>

      <para>For &intel; (i915) systems after Broadwell&trade;, the
	&man.rc.conf.5; entry is:</para>

      <programlisting>kld_list="/boot/modules/i915kms.ko"</programlisting>

      <para>Systems with ATI/&amd; graphics cards have two options.
	Modern systems starting with the HD7000 series GPU should
	use:</para>

      <programlisting>kld_list="/boot/modules/amdgpu.ko"</programlisting>

      <para>Systems with cards released before the HD7000 GPU
	use:</para>

      <programlisting>kld_list="/boot/modules/radeonkms.ko"</programlisting>

      <note>
	<para>Users must be added to the <literal>video</literal>
	  <acronym>GID</acronym> after installing <filename
	    role="package">graphics/drm-kmod</filename> in order for
	  <application>X</application> to start properly.</para>
      </note>

      <note>
	<para>There are known issues with the
	  <literal>xserver</literal> driver provided by <filename
	    role="package">x11-drivers/xf86-video-ati</filename>
	  when using graphics drivers from the base system;
	  <filename
	    role="package">x11-drivers/xf86-video-ati-legacy</filename>
	  should be used instead.</para>
      </note>

      <note>
	<para>There is a known issue where booting with
	  <acronym>UEFI</acronym> and using the ATI/&amd; graphics
	  driver may cause the screen to be garbled before the
	  appropriate driver is loaded.</para>
      </note>

      <para>For additional information regarding graphics support on
	&os;, please see the <link
	  xlink:href="https://wiki.freebsd.org/Graphics">Graphics Wiki
	  Page</link>.</para>
    </sect2>

    <sect2 xml:id="hardware-virtualization">
      <title>Virtualization Support</title>

      <para revision="325254">Amazon&reg; EC2&trade; AMI instances now
	have <filename
	  role="package">sysutils/amazon-ssm-agent</filename>
	installed by default, though the service is not enabled by
	default in &man.rc.conf.5;.  To enable the service,
	add:</para>

      <programlisting>	>>/etc/rc.conf
	amazon_ssm_agent_enable="YES"</programlisting>

      <para>to the EC2&trade; user-data.</para>

      <para revision="326564">Amazon&reg; EC2&trade; AMI instances now
	disable <literal>ChallengeResponseAuthentication</literal> in
	&man.sshd.config.5; by default.</para>

      <para revision="326565">Amazon&reg; EC2&trade; AMI instances now
	use the Amazon&reg; internal <application>NTP</application>
	service by default.</para>

      <para revision="332298">The &man.bhyve.8; utility has been
	updated to allow controlling <acronym>CPU</acronym> topology
	from userland.</para>

      <para revision="334940" contrib="sponsor" sponsor="&ix;">The
	&man.bhyve.8; utility has been updated to add
	&man.virtio.scsi.4; storage support.</para>

      <para revision="335974" contrib="sponsor" sponsor="&ix;">The
	&man.bhyve.8; utility has been updated to add
	<acronym>NVMe</acronym> device emulation.</para>

      <para revision="337023" contrib="sponsor"
	sponsor="&hbsd;, &g2inc;">A new &man.sysctl.8;,
	<literal>security.jail.vmm_allowed</literal>, has been added,
	which when set to <literal>1</literal> allows &man.bhyve.8;
	use within a &man.jail.8;.</para>

      <para revision="338321">Amazon&reg; EC2&trade; AMI instances now
	disable the PS/2 keyboard and mouse devices by default,
	reducing overall boot time by 2.5 seconds.</para>
    </sect2>

    <sect2 xml:id="hardware-arm">
      <title>ARM Support</title>

      <para revision="335004" contrib="sponsor" sponsor="&ff;">Support
	for the <acronym>USB</acronym> <acronym>OTG</acronym> serial
	terminal has been enabled on &arch.arm; systems by
	default.</para>

      <para revision="336998">The &arch.armv6; and &arch.armv7; images
	now default to boot with <acronym>EFI</acronym>.</para>

      <para revision="337000">Support has been added for building
	&arch.arm64; images for the <filename>PINE64-LTS</filename>
	system.</para>

      <para revision="338666" contrib="sponsor" sponsor="&ff;">Support
	for &man.capsicum.4; has been enabled on &arch.armv6; and
	&arch.armv7; by default.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="storage">
    <title>Storage</title>

    <para>This section covers changes and additions to file systems
      and other storage subsystems, both local and networked.</para>

    <sect2 xml:id="storage-general">
      <title>General Storage</title>

      <para revision="323923">The
	<acronym>UFS</acronym>/<acronym>FFS</acronym> filesystem
	has been updated to support check hashes to cylinder-group
	maps.  Support for check hashes is available only for
	<acronym>UFS</acronym>2.</para>

      <para revision="333446" contrib="sponsor" sponsor="&ix;">The
	<acronym>CAM</acronym> Target Layer (<acronym>CTL</acronym>)
	frontend and backend options have been overhauled to use
	&man.nv.3; allowing creating multiple &man.ioctl.2; frontend
	ports.</para>

      <para revision="337749" contrib="sponsor"
	sponsor="&darpa_afrl;">The default &man.auto.master.5;
	configuration has been updated to add the
	<literal>noautoro</literal> &man.automount.8; flag to the
	<filename class="directory">/media</filename> mount
	point (commented by default).</para>

      <para revision="338056" contrib="sponsor"
	sponsor="&netflix;">The
	<acronym>UFS</acronym>/<acronym>FFS</acronym> filesystem has
	been updated to consolidate
	<acronym>TRIM</acronym>/<literal>BIO_DELETE</literal>
	commands, reducing read/write requests due to fewer
	<acronym>TRIM</acronym> messages being sent
	simultaneously.</para>

      <para revision="338517" contrib="sponsor"
	sponsor="&netflix;"><acronym>TRIM</acronym> consolidation
	support has been enabled by default in the
	<acronym>UFS</acronym>/<acronym>FFS</acronym> filesystem.
	<acronym>TRIM</acronym> consolidation can be disabled by
	setting the <literal>vfs.ffs.dotrimcons</literal>
	&man.sysctl.8; to <literal>0</literal>, or adding
	<literal>vfs.ffs.dotrimcons=0</literal> to
	&man.sysctl.conf.5;.</para>

      <para revision="338640" contrib="sponsor"
	sponsor="&darpa_afrl;">The &man.geom.8; utility has been
	updated to add a new flag, <literal>-p</literal>, which
	prints the <acronym>GEOM</acronym> class of the specified
	provider.</para>

      <para revision="338684" contrib="sponsor"
	sponsor="&darpa_afrl;">The &man.geom.8; utility has been
	updated to add a new flag, <literal>-t</literal>, which
	prints the <acronym>GEOM</acronym> hierarchy.</para>
    </sect2>

    <sect2 xml:id="storage-net">
      <title>Networked Storage</title>

      <para revision="335012">The <acronym>NFS</acronym> version 4.1
	server has been updated to include <acronym>pNFS</acronym>
	server support.</para>
    </sect2>

    <sect2 xml:id="storage-zfs">
      <title>ZFS</title>

      <para revision="334844"><acronym>ZFS</acronym> has been updated
	to include new &man.sysctl.8;s,
	<literal>vfs.zfs.arc_min_prefetch_ms</literal> and
	<literal>vfs.zfs.arc_min_prescient_prefetch_ms</literal>,
	which improve performance of the &man.zpool.8;
	<literal>scrub</literal> subcommand.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="boot">
    <title>Boot Loader Changes</title>

    <para>This section covers the boot loader, boot menu, and other
      boot-related changes.</para>

    <sect2 xml:id="boot-loader">
      <title>Boot Loader Changes</title>

      <para revision="329501" contrib="sponsor"
	sponsor="&dellemc;">The lua &man.loader.8; has been updated to
	detect a list of installed kernels to boot.</para>

      <para revision="336252" contrib="sponsor"
	sponsor="&microchip;">The &man.loader.8; has been updated to
	support &man.geli.8; for all architectures and all disk-like
	devices.</para>

      <para revision="337321" contrib="sponsor"
	sponsor="&darpa_afrl;">The &man.init.8; utility has been
	updated to be able to run an executable written in languages
	other than &man.sh.1;, such as
	<application>Python</application>, for example.</para>

      <para revision="337715" contrib="sponsor" sponsor="&ff;">The
	&man.loader.8; has been updated to add support for loading
	&intel; microcode updates early during the boot
	process.</para>

      <para revision="337740" contrib="sponsor"
	sponsor="&darpa_afrl;">A new &man.kenv.1; variable,
	<literal>init_exec</literal>, has been added to &man.loader.8;
	which allows &man.init.8; to execute a file after opening the
	console, replacing &man.init.8; as <acronym>PID</acronym>
	<literal>1</literal>.</para>

      <para revision="338050">The default &man.libstand.3; interpreter
	has been changed to <application>Lua</application>.</para>

      <para revision="339218">The lua &man.loader.8; has been updated
	to support module blacklists.</para>

      <para revision="339308">The default lua &man.loader.conf.5; has
	been updated to include the
	<literal>kernels_autodetect</literal> option, which defaults
	to <literal>YES</literal>, supplementing the &man.loader.8;
	support to list available kernels to boot introduced in
	revision <literal>329501</literal>.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="network">
    <title>Networking</title>

    <para>This section describes changes that affect networking in
      &os;.</para>

    <sect2 xml:id="network-general">
      <title>General Network</title>

      <para revision="333322" contrib="sponsor" sponsor="&ix;">The
	&man.carp.4; interface has been updated to keep the state as
	<literal>INIT</literal> instead of <literal>MASTER</literal>
	when the <literal>net.inet.carp.allow</literal> &man.sysctl.8;
	is set to <literal>0</literal>.</para>

      <para>The &man.pf.4; packet filter is now usable within
	a &man.jail.8; using &man.vnet.9;.</para>

      <para revision="334375">The &man.pf.4; packet filter has been
	updated to use &man.rmlock.9; instead of &man.rwlock.9;,
	resulting in significant performance improvements.</para>

      <para revision="334719" contrib="sponsor"
	sponsor="&limelight;">The <literal>SO_REUSEPORT_LB</literal>
	option has been added to the network stack, allowing multiple
	programs or threads to bind to the same port, and incoming
	connections load balanced using a hash function.</para>

      <para revision="338253">The &man.pf.4; ioctl interface and
	&man.pfctl.8; now support &man.altq.4; bandwidth parameters of
	<literal>2^32</literal> bps or greater.  The
	<acronym>HFSC</acronym> discipline has been upgraded to
	operate correctly with bandwidth parameters up to 100 Gbps,
	and bandwidth parameters supplied to the non-upgraded
	disciplines will now be saturated at the prior 32-bit
	limit.</para>
    </sect2>

    <sect2 xml:id="network-protocols">
      <title>Network Protocols</title>

      <para revision="331714" contrib="sponsor"
	sponsor="&darpa_afrl;">Support for token-ring networks has
	been removed.</para>

      <para revision="332490" contrib="sponsor"
	sponsor="&darpa_afrl;">Support for the Arcnet protocol has
	been removed.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="ports">
    <title>Ports Collection and Package Infrastructure</title>

    <para>This section covers changes to the &os;&nbsp;Ports
      Collection, package infrastructure, and package maintenance and
      installation tools.</para>

    <sect2 xml:id="ports-packages ">
      <title>Packaging Changes</title>

      <para>The &man.pkg.8; utility has been updated to verson
	1.10.5_5.</para>

      <para><application>KDE</application> has been updated to version
	5.12.5.</para>

      <para><application>Perl</application> has been updated to
	version 5.26.2.</para>

      <para><application>Python</application> has been updated to
	version 2.7.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="doc">
    <title>Documentation</title>

    <para>This section covers changes to the &os;&nbsp;Documentation
      Project sources and toolchain.</para>

    <sect2 xml:id="doc-sources">
      <title>Documentation Source Changes</title>

      <para revision="303033" contrib="sponsor" sponsor="&ff;">The
	&man.arch.7; manual page has been added, containing details
	specific to certain architectures.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="releng">
    <title>Release Engineering and Integration</title>

    <para>This section convers changes that are specific to the
      &os;&nbsp;Release Engineering processes.</para>

    <sect2 xml:id="releng-changes">
      <title>Integration Changes</title>

      <para revision="332446" contrib="sponsor" sponsor="&ff;">The
	&os;/&arch.i386; memory stick installation images have been
	changed to use the <acronym>MBR</acronym> partitioning scheme
	instead of <acronym>GPT</acronym> to address boot issues with
	some <acronym>BIOS</acronym>es.</para>

      <para revision="334337" contrib="sponsor" sponsor="&ff;">The
	&os;/&arch.amd64; memory stick installation images have been
	changed to use the <acronym>MBR</acronym> partitioning scheme
	instead of <acronym>GPT</acronym> to address boot issues with
	some <acronym>BIOS</acronym>es.</para>
    </sect2>
  </sect1>
</article>
